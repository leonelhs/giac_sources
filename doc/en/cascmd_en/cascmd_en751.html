<!DOCTYPE html>
<html >
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="hevea 2.29+5 of 2017-05-18">
<link rel="stylesheet" type="text/css" href="cascmd_en.css">
<title>Finding approximate solutions to systems of equations</title>
</head>
<body >
<a href="cascmd_en750.html"><img src="previous_motif.gif" alt="Previous"></a>
<a href="index.html"><img src="contents_motif.gif" alt="Up"></a>
<a href="cascmd_en752.html"><img src="next_motif.gif" alt="Next"></a>
<hr>
<h3 id="sec1944" class="subsection">23.3.3  Finding approximate solutions to systems of equations</h3>
<p>In Section <a href="cascmd_en750.html#sec%3Afsolve">23.3.2</a>
it was shown how to use the
<span style="font-family:monospace">fsolve</span><a id="hevea_default1510"></a> and
<span style="font-family:monospace">cfsolve</span><a id="hevea_default1511"></a> commands
to solve equations. This section will discuss systems of equations.</p><p>As before, the <span style="font-family:monospace">cfsolve</span><a id="hevea_default1512"></a>
command is the complex version of
<span style="font-family:monospace">fsolve</span>, with the same arguments. The only difference is that
<span style="font-family:monospace">cfsolve</span> gives numeric solutions over the complex numbers,
even if <span style="font-variant:small-caps">Xcas</span> is not in complex mode (see
Section <a href="cascmd_en028.html#ssec%3Acomplex">2.5.5</a>). <span style="font-family:monospace">fsolve</span> will return complex roots,
but only in complex mode.</p><ul class="itemize"><li class="li-itemize">
For solving systems of equations,
<span style="font-family:monospace">fsolve</span> takes three mandatory arguments and one
optional argument:
<ul class="itemize"><li class="li-itemize">
<span style="font-style:italic">eqns</span>, a list of equations (or expressions,
considered to be equal to zero) to solve.
</li><li class="li-itemize"><span style="font-family:monospace">vars</span>, a list of the variables.
</li><li class="li-itemize">Optionally, <span style="font-family:monospace">init</span>, a list initial values for the variables. 
</li><li class="li-itemize">Optionally, <span style="font-style:italic">method</span>, the method to use. The possible methods are:<br>
 <span style="font-family:monospace">dnewton_solver</span><a id="hevea_default1513"></a>,
<span style="font-family:monospace">hybrid_solver</span><a id="hevea_default1514"></a>,
<span style="font-family:monospace">hybrids_solver</span><a id="hevea_default1515"></a>,
<span style="font-family:monospace">newtonj_solver</span><a id="hevea_default1516"></a>,
<span style="font-family:monospace">hybridj_solver</span><a id="hevea_default1517"></a>, and
<span style="font-family:monospace">hybridsj_solver</span><a id="hevea_default1518"></a>.
</li></ul>
</li><li class="li-itemize"><span style="font-family:monospace">fsolve(</span><span style="font-style:italic">eqns</span>,<span style="font-style:italic">vars</span> ⟨,<span style="font-style:italic">init</span>,<span style="font-style:italic">method</span> ⟩<span style="font-family:monospace">)</span>
returns an approximate solution to <span style="font-style:italic">eqns</span>.
</li><li class="li-itemize">The methods are inherited from the GSL. The methods whose names end
with <span style="font-family:monospace">j_solver</span> use the jacobian matrix, the rest use
approximations for the derivatives.
All methods use an iteration of Newton kind
<table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">    <span style="font-style:italic">x</span><sub><span style="font-style:italic">n</span>+1</sub>=<span style="font-style:italic">x</span><sub><span style="font-style:italic">n</span></sub>−</td><td class="dcell"><table class="display"><tr><td class="dcell" style="text-align:center"><span style="font-style:italic">f</span>(<span style="font-style:italic">x</span><sub><span style="font-style:italic">n</span></sub>)</td></tr>
<tr><td class="hbar"></td></tr>
<tr><td class="dcell" style="text-align:center"><span style="font-style:italic">f</span>′(<span style="font-style:italic">x</span><sub><span style="font-style:italic">n</span></sub>)</td></tr>
</table></td></tr>
</table>
The four hybrid methods also apply the method of gradient descent when
the Newton iteration would make a too large of a
step. The length of the step is computed without scaling
for <span style="font-family:monospace">hybrid_solver</span> and <span style="font-family:monospace">hybridj_solver</span>
or with scaling (computed from <span style="font-style:italic">f</span>′(<span style="font-style:italic">x</span><sub><span style="font-style:italic">n</span></sub>)) for
<span style="font-family:monospace">hybrids_solver</span> and <span style="font-family:monospace">hybridsj_solver</span>.
</li></ul><h4 id="sec1945" class="subsubsection">Examples</h4>
<p>
Input in real mode:

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">fsolve</span></span><span style="font-weight:bold"><span style="color:#BF0000">([</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">^2+</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">+1,</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">+</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">^2-1],[</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">])</span></span></td></tr>
</table><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">
     

</td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:right;white-space:nowrap" ><table class="display"><tr style="vertical-align:middle"><td class="dcell"><span style="color:#0000CC">
</span></td><td class="dcell"><table class="display"><tr style="vertical-align:middle"><td class="dcell"><span style="color:#0000CC">⎡<br>
⎢<br>
⎣</span></td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">0.0</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">−1.0</span></td></tr>
<tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">−0.453397651516</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">−1.2055694304</span></td></tr>
</table></td><td class="dcell"><span style="color:#0000CC">⎤<br>
⎥<br>
⎦</span></td></tr>
</table></td></tr>
</table></td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td></tr>
</table></td></tr>
</table><p>
Input in complex mode:

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">fsolve</span></span><span style="font-weight:bold"><span style="color:#BF0000">([</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">^2+</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">+1,</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">+</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">^2-1],[</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">])</span></span></td></tr>
</table><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">
     

</td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:right;white-space:nowrap" ><table class="display"><tr style="vertical-align:middle"><td class="dcell"><span style="color:#0000CC">
</span></td><td class="dcell"><table class="display"><tr style="vertical-align:middle"><td class="dcell"><span style="color:#0000CC">⎡<br>
⎢<br>
⎢<br>
⎢<br>
⎣</span></td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">0.0</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">−1.0</span></td></tr>
<tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">0.226698825758−1.46771150871 </span><span style="color:#0000CC"><span style="font-style:italic">i</span></span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">1.1027847152+0.665456951153 </span><span style="color:#0000CC"><span style="font-style:italic">i</span></span></td></tr>
<tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">0.226698825758+1.46771150871 </span><span style="color:#0000CC"><span style="font-style:italic">i</span></span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">1.1027847152−0.665456951153 </span><span style="color:#0000CC"><span style="font-style:italic">i</span></span></td></tr>
<tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">−0.453397651516</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">−1.2055694304</span></td></tr>
</table></td><td class="dcell"><span style="color:#0000CC">⎤<br>
⎥<br>
⎥<br>
⎥<br>
⎦</span></td></tr>
</table></td></tr>
</table></td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td></tr>
</table></td></tr>
</table><p>
Input in any mode:

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">cfsolve</span></span><span style="font-weight:bold"><span style="color:#BF0000">([</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">^2+</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">+1,</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">+</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">^2-1],[</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">])</span></span></td></tr>
</table><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">
     

</td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:right;white-space:nowrap" ><table class="display"><tr style="vertical-align:middle"><td class="dcell"><span style="color:#0000CC">
</span></td><td class="dcell"><table class="display"><tr style="vertical-align:middle"><td class="dcell"><span style="color:#0000CC">⎡<br>
⎢<br>
⎢<br>
⎢<br>
⎣</span></td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">0.0</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">−1.0</span></td></tr>
<tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">0.226698825758−1.46771150871 </span><span style="color:#0000CC"><span style="font-style:italic">i</span></span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">1.1027847152+0.665456951153 </span><span style="color:#0000CC"><span style="font-style:italic">i</span></span></td></tr>
<tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">0.226698825758+1.46771150871 </span><span style="color:#0000CC"><span style="font-style:italic">i</span></span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">1.1027847152−0.665456951153 </span><span style="color:#0000CC"><span style="font-style:italic">i</span></span></td></tr>
<tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">−0.453397651516</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">−1.2055694304</span></td></tr>
</table></td><td class="dcell"><span style="color:#0000CC">⎤<br>
⎥<br>
⎥<br>
⎥<br>
⎦</span></td></tr>
</table></td></tr>
</table></td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td></tr>
</table></td></tr>
</table><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">cfsolve</span></span><span style="font-weight:bold"><span style="color:#BF0000">([</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">^2+</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">+2,</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">+</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">^2+2],[</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">])</span></span></td></tr>
</table><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">
     

</td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:right;white-space:nowrap" ><table class="display"><tr style="vertical-align:middle"><td class="dcell"><span style="color:#0000CC">
</span></td><td class="dcell"><table class="display"><tr style="vertical-align:middle"><td class="dcell"><span style="color:#0000CC">⎡<br>
⎢<br>
⎢<br>
⎢<br>
⎣</span></td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">0.5+1.65831239518 </span><span style="color:#0000CC"><span style="font-style:italic">i</span></span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">0.5−1.65831239518 </span><span style="color:#0000CC"><span style="font-style:italic">i</span></span></td></tr>
<tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">0.5−1.65831239518 </span><span style="color:#0000CC"><span style="font-style:italic">i</span></span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">0.5+1.65831239518 </span><span style="color:#0000CC"><span style="font-style:italic">i</span></span></td></tr>
<tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">−0.5+1.32287565553 </span><span style="color:#0000CC"><span style="font-style:italic">i</span></span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">−0.5+1.32287565553 </span><span style="color:#0000CC"><span style="font-style:italic">i</span></span></td></tr>
<tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">−0.5−1.32287565553 </span><span style="color:#0000CC"><span style="font-style:italic">i</span></span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">−0.5−1.32287565553 </span><span style="color:#0000CC"><span style="font-style:italic">i</span></span></td></tr>
</table></td><td class="dcell"><span style="color:#0000CC">⎤<br>
⎥<br>
⎥<br>
⎥<br>
⎦</span></td></tr>
</table></td></tr>
</table></td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td></tr>
</table></td></tr>
</table><h4 id="sec1946" class="subsubsection">Example</h4>
<table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">fsolve</span></span><span style="font-weight:bold"><span style="color:#BF0000">([</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">^2+</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">-2,</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">+</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">^2-2],[</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">],[2,2],</span></span><span style="font-weight:bold"><span style="color:#BF0000">dnewton_solver</span></span><span style="font-weight:bold"><span style="color:#BF0000">)</span></span></td></tr>
</table><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">
     

</td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:right;white-space:nowrap" ><table class="display"><tr style="vertical-align:middle"><td class="dcell"><span style="color:#0000CC">
</span></td><td class="dcell"><span style="color:#0000CC">⎡<br>
⎣</span></td><td class="dcell"><span style="color:#0000CC">1.0,1.0</span></td><td class="dcell"><span style="color:#0000CC">⎤<br>
⎦</span></td></tr>
</table></td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td></tr>
</table></td></tr>
</table>
<hr>
<a href="cascmd_en750.html"><img src="previous_motif.gif" alt="Previous"></a>
<a href="index.html"><img src="contents_motif.gif" alt="Up"></a>
<a href="cascmd_en752.html"><img src="next_motif.gif" alt="Next"></a>
</body>
</html>
