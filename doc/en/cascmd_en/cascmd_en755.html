<!DOCTYPE html>
<html >
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="hevea 2.29+5 of 2017-05-18">
<link rel="stylesheet" type="text/css" href="cascmd_en.css">
<title>Approximating solutions of boundary value problems</title>
</head>
<body >
<a href="cascmd_en754.html"><img src="previous_motif.gif" alt="Previous"></a>
<a href="index.html"><img src="contents_motif.gif" alt="Up"></a>
<a href="cascmd_en756.html"><img src="next_motif.gif" alt="Next"></a>
<hr>
<h3 id="sec1954" class="subsection">23.4.3  Approximating solutions of boundary value problems</h3>
<p>The <span style="font-family:monospace">bvpsolve</span><a id="hevea_default1524"></a>
command finds an approximate solution ŷ(<span style="font-style:italic">t</span>) of a boundary value problem
</p><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">  <span style="font-style:italic">y</span>′′=<span style="font-style:italic">f</span>(<span style="font-style:italic">t</span>,<span style="font-style:italic">y</span>,<span style="font-style:italic">y</span>′),   <span style="font-style:italic">y</span>(<span style="font-style:italic">a</span>)=α, <span style="font-style:italic">y</span>(<span style="font-style:italic">b</span>)=β
</td></tr>
</table><p>
on the interval [<span style="font-style:italic">a</span>,<span style="font-style:italic">b</span>]. The procedure uses the method of nonlinear
shooting which is based on Newton and Runge-Kutta methods. Values of
<span style="font-style:italic">y</span> and its first derivative <span style="font-style:italic">y</span>′ are approximated at points
<span style="font-style:italic">t</span><sub><span style="font-style:italic">k</span></sub>=<span style="font-style:italic">a</span>+<span style="font-style:italic">k</span> δ, where δ=<span style="font-style:italic">b</span>−<span style="font-style:italic">a</span>/<span style="font-style:italic">N</span> and <span style="font-style:italic">k</span>=0,1,…,<span style="font-style:italic">N</span>.
</p><ul class="itemize"><li class="li-itemize">
<span style="font-family:monospace">bvpsolve</span> takes three mandatory arguments and four
optional arguments:
<ul class="itemize"><li class="li-itemize">
<span style="font-style:italic">f</span>(<span style="font-style:italic">t</span>,<span style="font-style:italic">y</span>,<span style="font-style:italic">y</span>′), an expression defining <span style="font-style:italic">y</span>′′.
</li><li class="li-itemize">[<span style="font-style:italic">t</span>=<span style="font-style:italic">a</span><span style="font-family:monospace">..</span><span style="font-style:italic">b</span>,<span style="font-style:italic">y</span>], a list specifying the variable <span style="font-style:italic">t</span>,
its range [<span style="font-style:italic">a</span>,<span style="font-style:italic">b</span>] and the sought function <span style="font-style:italic">y</span>.
</li><li class="li-itemize">[α,β], a list of the boundary values of <span style="font-style:italic">y</span>.
</li><li class="li-itemize">Optionally, <span style="font-style:italic">A</span>, an initial guess for <span style="font-style:italic">y</span>′(<span style="font-style:italic">a</span>) (by default,
(β−α)/(<span style="font-style:italic">b</span>−<span style="font-style:italic">a</span>)).
</li><li class="li-itemize">Optionally, <span style="font-style:italic">N</span>, an integer greater than or equal to 2 (by
default 100).
</li><li class="li-itemize">Optionally, <span style="font-family:monospace">output=</span><span style="font-style:italic">type</span> or
<span style="font-family:monospace">Output=</span><span style="font-style:italic">type</span>, the type of the output, where
<span style="font-style:italic">type</span> can be one of: <span style="font-family:monospace">list</span> (the default),
<span style="font-family:monospace">diff</span>, <span style="font-family:monospace">piecewise</span> or <span style="font-family:monospace">spline</span>.
</li><li class="li-itemize">Optionally, <span style="font-family:monospace">limit=</span><span style="font-style:italic">M</span>, a positive integer for a limit for the
number of iterations before the procedure is stopped
(by default there is no limit). 
</li></ul>
</li><li class="li-itemize"><span style="font-family:monospace">bvpsolve(</span><span style="font-style:italic">f</span>(<span style="font-style:italic">t</span>,<span style="font-style:italic">y</span>,<span style="font-style:italic">y</span>′),[<span style="font-style:italic">t</span>=<span style="font-style:italic">a</span><span style="font-family:monospace">..</span><span style="font-style:italic">b</span>,<span style="font-style:italic">y</span>],[α,β] ⟨,<span style="font-style:italic">A</span>,<span style="font-style:italic">N</span>,
<span style="font-family:monospace">output=</span><span style="font-style:italic">type</span>,<span style="font-family:monospace">limit=</span><span style="font-style:italic">M</span> ⟩<span style="font-family:monospace">)</span> returns:
<ul class="itemize"><li class="li-itemize">
with <span style="font-style:italic">type</span>=<span style="font-family:monospace">list</span>, a list of pairs [<span style="font-style:italic">t</span><sub><span style="font-style:italic">k</span></sub>,<span style="font-style:italic">y</span><sub><span style="font-style:italic">k</span></sub>] where <span style="font-style:italic">y</span><sub><span style="font-style:italic">k</span></sub>≈ <span style="font-style:italic">y</span>(<span style="font-style:italic">t</span><sub><span style="font-style:italic">k</span></sub>),
</li><li class="li-itemize">with <span style="font-style:italic">type</span>=<span style="font-family:monospace">diff</span>, a list of triples [<span style="font-style:italic">t</span><sub><span style="font-style:italic">k</span></sub>,<span style="font-style:italic">y</span><sub><span style="font-style:italic">k</span></sub>,<span style="font-style:italic">y</span>′<sub><span style="font-style:italic">k</span></sub>],
where <span style="font-style:italic">y</span>′<sub><span style="font-style:italic">k</span></sub>≈ <span style="font-style:italic">y</span>′(<span style="font-style:italic">t</span><sub><span style="font-style:italic">k</span></sub>),
</li><li class="li-itemize">with <span style="font-style:italic">type</span>=<span style="font-family:monospace">piecewise</span>, a piecewise linear interpolation of the
points (<span style="font-style:italic">t</span><sub><span style="font-style:italic">k</span></sub>,<span style="font-style:italic">y</span><sub><span style="font-style:italic">k</span></sub>),
</li><li class="li-itemize">with <span style="font-style:italic">type</span>=<span style="font-family:monospace">spline</span>, a piecewise spline interpolation of the
points (<span style="font-style:italic">t</span><sub><span style="font-style:italic">k</span></sub>,<span style="font-style:italic">y</span><sub><span style="font-style:italic">k</span></sub>), based on the values <span style="font-style:italic">y</span>′<sub><span style="font-style:italic">k</span></sub> computed in the
process. 
</li></ul>
</li></ul><p>Note that the shooting method is sensitive to roundoff errors and may
fail to converge in some cases, especially when <span style="font-style:italic">y</span> is a rapidly
increasing function. In the absence of convergence or if the maximum
number of iterations is exceeded, <span style="font-family:monospace">bvpsolve</span> returns
<span style="font-family:monospace">undef</span>. However, if the output type is <span style="font-family:monospace">list</span> or
<span style="font-family:monospace">piecewise</span> and if <span style="font-style:italic">N</span>&gt;2, a slower but more stable
finite-difference method (which approximates only the function <span style="font-style:italic">y</span>) is
tried first.</p><p>Sometimes setting an initial guess <span style="font-style:italic">A</span> for <span style="font-style:italic">y</span>′(<span style="font-style:italic">a</span>) to a suitable value
may help the shooting algorithm to converge or to converge faster.</p><h4 id="sec1955" class="subsubsection">Examples</h4>
<p>
Solve <span style="font-style:italic">y</span>′′=1/8 (32+2 <span style="font-style:italic">t</span><sup>3</sup>−<span style="font-style:italic">y</span> <span style="font-style:italic">y</span>′) with 1≤ <span style="font-style:italic">t</span>≤ 3 and
boundary conditions <span style="font-style:italic">y</span>(1)=17 and <span style="font-style:italic">y</span>(3)=43/3 (the exact solution is <span style="font-style:italic">y</span>(<span style="font-style:italic">t</span>)=<span style="font-style:italic">t</span><sup>2</sup>+16/<span style="font-style:italic">t</span>).
Use <span style="font-style:italic">N</span>=20, which gives an <span style="font-style:italic">t</span>-step of 0.01. To display approximated and exact
values together, enter:

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">aprx</span></span><span style="font-weight:bold"><span style="color:#BF0000">:=</span></span><span style="font-weight:bold"><span style="color:#BF0000">bvpsolve</span></span><span style="font-weight:bold"><span style="color:#BF0000">((32+2</span></span><span style="font-weight:bold"><span style="color:#BF0000">t</span></span><span style="font-weight:bold"><span style="color:#BF0000">^3-</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">*</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">')/8,[</span></span><span style="font-weight:bold"><span style="color:#BF0000">t</span></span><span style="font-weight:bold"><span style="color:#BF0000">=1..3,</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">],[17,43/3],20):;</span></span><span style="font-weight:bold"><span style="color:#BF0000">
 </span></span><span style="font-weight:bold"><span style="color:#BF0000">exct</span></span><span style="font-weight:bold"><span style="color:#BF0000">:=</span></span><span style="font-weight:bold"><span style="color:#BF0000">apply</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">t</span></span><span style="font-weight:bold"><span style="color:#BF0000">-&gt;</span></span><span style="font-weight:bold"><span style="color:#BF0000">t</span></span><span style="font-weight:bold"><span style="color:#BF0000">^2+16/</span></span><span style="font-weight:bold"><span style="color:#BF0000">t</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">linspace</span></span><span style="font-weight:bold"><span style="color:#BF0000">(1.0,3.0,21)):;</span></span><span style="font-weight:bold"><span style="color:#BF0000">
 </span></span><span style="font-weight:bold"><span style="color:#BF0000">prepend</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">border</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">aprx</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">exct</span></span><span style="font-weight:bold"><span style="color:#BF0000">),[</span></span><span style="font-weight:bold"><span style="color:#BF0000">t</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">y_k</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">t_k</span></span><span style="font-weight:bold"><span style="color:#BF0000">)])</span></span></td></tr>
</table><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">
     

</td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:right;white-space:nowrap" ><table class="display"><tr style="vertical-align:middle"><td class="dcell"><span style="color:#0000CC">
</span></td><td class="dcell"><span style="color:#0000CC">⎡<br>
⎢<br>
⎢<br>
⎢<br>
⎢<br>
⎢<br>
⎢<br>
⎢<br>
⎢<br>
⎢<br>
⎢<br>
⎢<br>
⎢<br>
⎣</span></td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC"><span style="font-style:italic">t</span></span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC"><span style="font-style:italic">y</span></span><sub><span style="color:#0000CC"><span style="font-style:italic">k</span></span></sub></td><td style="text-align:center;white-space:nowrap" ><table class="display"><tr style="vertical-align:middle"><td class="dcell"><span style="color:#0000CC"><span style="font-style:italic">y</span></span></td><td class="dcell"><span style="color:#0000CC">⎛<br>
⎝</span></td><td class="dcell"><span style="color:#0000CC"><span style="font-style:italic">t</span></span><sub><span style="color:#0000CC"><span style="font-style:italic">k</span></span></sub></td><td class="dcell"><span style="color:#0000CC">⎞<br>
⎠</span></td></tr>
</table></td></tr>
<tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">  1.0</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">17.0</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">17.0</span></td></tr>
<tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">1.1</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">15.7554961579</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">15.7554545455</span></td></tr>
<tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">  1.2</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">14.7733911821</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">14.7733333333</span></td></tr>
<tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">  1.3</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">13.9977543159</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">13.9976923077</span></td></tr>
<tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">  1.4</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">13.388631813</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">13.3885714286</span></td></tr>
<tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">  ⋮</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">⋮</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">⋮</span></td></tr>
<tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">2.8</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">13.5542890043</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">13.5542857143</span></td></tr>
<tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">  2.9</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">13.9272429048</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">13.9272413793</span></td></tr>
<tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">  3.0</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">14.3333333333</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">14.3333333333</span></td></tr>
</table></td><td class="dcell"><span style="color:#0000CC">⎤<br>
⎥<br>
⎥<br>
⎥<br>
⎥<br>
⎥<br>
⎥<br>
⎥<br>
⎥<br>
⎥<br>
⎥<br>
⎥<br>
⎥<br>
⎦</span></td></tr>
</table></td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td></tr>
</table></td></tr>
</table><p>As another example, solve <span style="font-style:italic">t</span><sup>5</sup> <span style="font-style:italic">y</span>′′=<span style="font-style:italic">t</span><sup>2</sup> <span style="font-style:italic">y</span>′<sup>2</sup>−9 <span style="font-style:italic">y</span><sup>2</sup>+4 <span style="font-style:italic">t</span><sup>6</sup>
with 1≤ <span style="font-style:italic">t</span>≤ 2 and boundary conditions <span style="font-style:italic">y</span>(1)=0 and <span style="font-style:italic">y</span>(2)=ln256.
Obtain the solution as a piecewise spline interpolation for <span style="font-style:italic">N</span>=10 and
estimate the absolute error <span style="font-family:monospace">err</span> of the approximation using
the exact solution <span style="font-style:italic">y</span>=<span style="font-style:italic">t</span><sup>3</sup> ln<span style="font-style:italic">t</span> and the <span style="font-family:monospace">romberg</span> command for
numerical integration. You need to explicitly set an initial guess
<span style="font-style:italic">A</span> for the value <span style="font-style:italic">y</span>′(1) because the algorithm fails to converge with the
default guess <span style="font-style:italic">A</span>=ln256≈ 5.545. Therefore let <span style="font-style:italic">A</span>=1
instead.

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">f</span></span><span style="font-weight:bold"><span style="color:#BF0000">:=(</span></span><span style="font-weight:bold"><span style="color:#BF0000">t</span></span><span style="font-weight:bold"><span style="color:#BF0000">^2*</span></span><span style="font-weight:bold"><span style="color:#BF0000">diff</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">t</span></span><span style="font-weight:bold"><span style="color:#BF0000">),</span></span><span style="font-weight:bold"><span style="color:#BF0000">t</span></span><span style="font-weight:bold"><span style="color:#BF0000">)^2-9*</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">t</span></span><span style="font-weight:bold"><span style="color:#BF0000">)^2+4*</span></span><span style="font-weight:bold"><span style="color:#BF0000">t</span></span><span style="font-weight:bold"><span style="color:#BF0000">^6)/</span></span><span style="font-weight:bold"><span style="color:#BF0000">t</span></span><span style="font-weight:bold"><span style="color:#BF0000">^5:;</span></span><span style="font-weight:bold"><span style="color:#BF0000">
 </span></span><span style="font-weight:bold"><span style="color:#BF0000">p</span></span><span style="font-weight:bold"><span style="color:#BF0000">:=</span></span><span style="font-weight:bold"><span style="color:#BF0000">bvpsolve</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">f</span></span><span style="font-weight:bold"><span style="color:#BF0000">,[</span></span><span style="font-weight:bold"><span style="color:#BF0000">t</span></span><span style="font-weight:bold"><span style="color:#BF0000">=1..2,</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">],[0,</span></span><span style="font-weight:bold"><span style="color:#BF0000">ln</span></span><span style="font-weight:bold"><span style="color:#BF0000">(256),1],10,</span></span><span style="font-weight:bold"><span style="color:#BF0000">output</span></span><span style="font-weight:bold"><span style="color:#BF0000">=</span></span><span style="font-weight:bold"><span style="color:#BF0000">spline</span></span><span style="font-weight:bold"><span style="color:#BF0000">):;</span></span><span style="font-weight:bold"><span style="color:#BF0000">
 </span></span><span style="font-weight:bold"><span style="color:#BF0000">err</span></span><span style="font-weight:bold"><span style="color:#BF0000">:=</span></span><span style="font-weight:bold"><span style="color:#BF0000">sqrt</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">romberg</span></span><span style="font-weight:bold"><span style="color:#BF0000">((</span></span><span style="font-weight:bold"><span style="color:#BF0000">p</span></span><span style="font-weight:bold"><span style="color:#BF0000">-</span></span><span style="font-weight:bold"><span style="color:#BF0000">t</span></span><span style="font-weight:bold"><span style="color:#BF0000">^3*</span></span><span style="font-weight:bold"><span style="color:#BF0000">ln</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">t</span></span><span style="font-weight:bold"><span style="color:#BF0000">))^2,</span></span><span style="font-weight:bold"><span style="color:#BF0000">t</span></span><span style="font-weight:bold"><span style="color:#BF0000">=1..2))</span></span></td></tr>
</table><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">
     

</td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:right;white-space:nowrap" ><span style="color:#0000CC">
3.27751904973×10</span><sup><span style="color:#0000CC">−6</span></sup><span style="color:#0000CC">
</span></td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td></tr>
</table></td></tr>
</table><p>
Note that, if the output type was set to <span style="font-family:monospace">list</span> or
<span style="font-family:monospace">piecewise</span>, the solution would have been found even without
specifying an initial guess for <span style="font-style:italic">y</span>′(1) because the algorithm would
automatically apply the alternative finite-difference method, which
converges.</p>
<hr>
<a href="cascmd_en754.html"><img src="previous_motif.gif" alt="Previous"></a>
<a href="index.html"><img src="contents_motif.gif" alt="Up"></a>
<a href="cascmd_en756.html"><img src="next_motif.gif" alt="Next"></a>
</body>
</html>
