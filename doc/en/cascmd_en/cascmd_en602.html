<!DOCTYPE html>
<html >
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="hevea 2.29+5 of 2017-05-18">
<link rel="stylesheet" type="text/css" href="cascmd_en.css">
<title>Minimization on bounded convex polyhedra</title>
</head>
<body >
<a href="cascmd_en601.html"><img src="previous_motif.gif" alt="Previous"></a>
<a href="index.html"><img src="contents_motif.gif" alt="Up"></a>
<a href="cascmd_en603.html"><img src="next_motif.gif" alt="Next"></a>
<hr>
<h3 id="sec1439" class="subsection">16.3.2  Minimization on bounded convex polyhedra</h3>
<p>The <span style="font-family:monospace">frank_wolfe</span><a id="hevea_default1057"></a> command finds
the minimum of a (twice) differentiable convex function <span style="font-style:italic">f</span>:ℝ<sup><span style="font-style:italic">n</span></sup>→ℝ
on a bounded convex polyhedron defined by the set <span style="font-style:italic">A</span>⊂ℝ<sup><span style="font-style:italic">n</span></sup> of its vertices by
using the method of Frank and Wolfe with backtracking.
The problem can be written as:
</p><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell"><a id="eq:fw"></a>
</td><td class="dcell"><table class="display"><tr><td class="dcell" style="text-align:center">&nbsp;</td></tr>
<tr><td class="dcell" style="text-align:center">min</td></tr>
<tr><td class="dcell" style="text-align:center"><span style="font-weight:bold"><span style="font-style:italic">x</span></span>∈<span style="font-style:italic">conv</span><span style="font-style:italic">A</span></td></tr>
</table></td><td class="dcell"> <span style="font-style:italic">f</span>(<span style="font-weight:bold"><span style="font-style:italic">x</span></span>),
    (2)</td></tr>
</table><p>
where conv<span style="font-style:italic">A</span> denotes the convex hull of <span style="font-style:italic">A</span>
which coincides with the given polyhedron.</p><p>Note that (<a href="#eq%3Afw">2</a>) can be solved efficiently for <span style="font-style:italic">n</span>=1 by using the
<span style="font-family:monospace">find_minimum</span> command (see Section <a href="cascmd_en601.html#ssec%3Afind-minimum">16.3.1</a>).
Therefore, <span style="font-family:monospace">frank_wolfe</span> requires that <span style="font-style:italic">n</span>≥ 2.
</p><ul class="itemize"><li class="li-itemize">
<span style="font-family:monospace">frank_wolfe</span> takes two mandatory arguments and a sequence of
optional arguments:
<ul class="itemize"><li class="li-itemize">
<span style="font-style:italic">obj</span>, which is either an <span style="font-weight:bold">expression</span> <span style="font-style:italic">f</span>(<span style="font-weight:bold"><span style="font-style:italic">x</span></span>)
(with at least two variables) or a vector containing two or three <span style="font-weight:bold">functions</span>
with arguments <span style="font-style:italic">x</span><sub>1</sub>,<span style="font-style:italic">x</span><sub>2</sub>,…,<span style="font-style:italic">x</span><sub><span style="font-style:italic">n</span></sub>, the first one returning <span style="font-style:italic">f</span>(<span style="font-weight:bold"><span style="font-style:italic">x</span></span>) and the
second one returning ∇ <span style="font-style:italic">f</span>(<span style="font-weight:bold"><span style="font-style:italic">x</span></span>). If the <span style="font-family:monospace">rand</span> option is used
(see below), then the third function should compute the Hessian matrix
∇<sup>2</sup><span style="font-style:italic">f</span>(<span style="font-weight:bold"><span style="font-style:italic">x</span></span>), otherwise it can be omitted.
</li><li class="li-itemize"><span style="font-style:italic">A</span>, a finite set of <span style="font-style:italic">m</span>≥ 2 points in ℝ<sup><span style="font-style:italic">n</span></sup> given
as a <span style="font-style:italic">m</span>× <span style="font-style:italic">n</span> matrix in which the <span style="font-style:italic">i</span>th row corresponds to the <span style="font-style:italic">i</span>th point.
</li><li class="li-itemize">Optionally, <span style="font-style:italic">opts</span>, a sequence of optional arguments
each of which is one of:
<ul class="itemize"><li class="li-itemize">
ε, a positive floating-point number specifying the tolerance
(by default, ε=0.001).
</li><li class="li-itemize"><span style="font-style:italic">N</span>, a positive integer specifying the maximal number of iterations
(by default, <span style="font-style:italic">N</span>=10<sup>5</sup>).
</li><li class="li-itemize"><span style="font-style:italic">initp</span>, a point in ℝ<sup><span style="font-style:italic">n</span></sup> given as a vector of <span style="font-style:italic">n</span> real numbers,
specifying the initial point <span style="font-weight:bold"><span style="font-style:italic">x</span></span><sub>0</sub> (by default, <span style="font-weight:bold"><span style="font-style:italic">x</span></span><sub><span style="font-weight:bold">0</span></sub> is the mean of
points in <span style="font-style:italic">A</span>, which is always feasible).
</li><li class="li-itemize"><span style="font-family:monospace">exact</span> or <span style="font-family:monospace">exact=</span><span style="font-style:italic">niter</span>,
a symbol specifying that the exact line search using Brent’s method should be performed.
By default, the <span style="font-family:monospace">step_size</span> subroutine by Pedregosa et al. (2020) is used, which is faster.
The parameter <span style="font-style:italic">niter</span> specifies the maximal number of iterations for the exact line-search
and its default value is 100. If <span style="font-style:italic">niter</span> is not specified, then the globally optimal step
size in [0,1] is searched for, otherwise a locally optimal one is returned.
</li><li class="li-itemize"><span style="font-family:monospace">rand</span> or <span style="font-family:monospace">rand=</span><span style="font-style:italic">npts</span>, a symbol specifying that the minimization
should be initiated from several random points instead of a single point to avoid being
stuck in a local minimum.
Initial points are found by generating <span style="font-style:italic">npts</span> (by default 1000) random points in
<span style="font-style:italic">conv</span><span style="font-style:italic">A</span> at which the objective function is convex. The generated points are clustered
and the Frank and Wolfe algorithm is run from the center of each cluster.
</li></ul>
</li></ul>
</li><li class="li-itemize"><span style="font-family:monospace">frank_wolfe(</span><span style="font-style:italic">obj</span>,<span style="font-style:italic">A</span>, ⟨<span style="font-style:italic">opts</span> ⟩<span style="font-family:monospace">)</span> returns
a feasible point <span style="font-weight:bold"><span style="font-style:italic">x</span></span> such that |<span style="font-style:italic">f</span>(<span style="font-weight:bold"><span style="font-style:italic">x</span></span><sup>∗</sup>)−<span style="font-style:italic">f</span><sup>∗</sup>|≤ ε,
where <span style="font-style:italic">f</span><sup>∗</sup> is the actual optimal objective function value in (<a href="#eq%3Afw">2</a>)
(note that local convexity of <span style="font-style:italic">f</span> is required to guarantee this).
If in some iteration, say <span style="font-style:italic">k</span>th, the step-size is zero to working precision,
or the maximal number of iterations is exceeded, the return value will be a vector of two elements:
a string containing the warning message and the last point <span style="font-weight:bold"><span style="font-style:italic">x</span></span><sub><span style="font-style:italic">k</span></sub>.
</li><li class="li-itemize">If <span style="font-style:italic">obj</span> is given as an expression, then the gradient and Hessian information
are computed automatically.
</li><li class="li-itemize">If the algorithm fails to minimize to the given precision, it is a good
idea to call <span style="font-family:monospace">frank_wolfe</span> again with the last point as the initial point and watch
for a possible improvement of the objective function value.
</li><li class="li-itemize"><span style="font-family:monospace">frank_wolfe</span> behaves well with optimal solution(s) lying at the boundary of
the feasible set, since the Frank and Wolfe method is automatically feasible.
</li><li class="li-itemize">Exact line search is several times slower than the default method but usually
makes the total number of the main-loop iterations smaller.
</li><li class="li-itemize">The <span style="font-family:monospace">rand</span> option helps handling problems with non-convex objective functions.
The algorithm finds an appropriate number of initial points in the set
{<span style="font-weight:bold"><span style="font-style:italic">x</span></span>∈<span style="font-style:italic">conv</span><span style="font-style:italic">A</span> : ∇<sup>2</sup><span style="font-style:italic">f</span>(<span style="font-weight:bold"><span style="font-style:italic">x</span></span>) is positive definite}
and (re)starts from each of them, thereby finding the global minimum in most cases.
If this approach fails, a warning message is printed an the provided initial point is
used instead, or one is generated as described above.
</li></ul><h4 id="sec1440" class="subsubsection">Examples</h4>
<h5 id="sec1441" class="paragraph">The Lasso Problem.</h5>
<p>
Solve the following ℓ<sup>1</sup>-constrained problem in <span style="font-style:italic">n</span> dimensions:
</p><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">min</td><td class="dcell"><table class="display"><tr><td class="dcell" style="text-align:center">1</td></tr>
<tr><td class="hbar"></td></tr>
<tr><td class="dcell" style="text-align:center">2</td></tr>
</table></td><td class="dcell">||<span style="font-style:italic">A</span><span style="font-weight:bold"><span style="font-style:italic">x</span></span>−<span style="font-weight:bold"><span style="font-style:italic">b</span></span>||<sup>2</sup>,   ||<span style="font-weight:bold"><span style="font-style:italic">x</span></span>||≤ 1,</td></tr>
</table><p>
where <span style="font-style:italic">A</span> is a <span style="font-style:italic">m</span>× <span style="font-style:italic">n</span> matrix with real coefficients, <span style="font-weight:bold"><span style="font-style:italic">x</span></span>∈ℝ<sup><span style="font-style:italic">n</span></sup> and
<span style="font-weight:bold"><span style="font-style:italic">b</span></span>∈ℝ<sup><span style="font-style:italic">m</span></sup>. It can be shown that vertices of the polyhedron defined
by ||<span style="font-weight:bold"><span style="font-style:italic">x</span></span>||<sub>1</sub>≤ 1 are defined by the orthonormal basis vectors and their counterparts
(2<span style="font-style:italic">n</span> vertices in total). Hence the set of vertices <span style="font-style:italic">V</span> can be represented by a matrix with
2<span style="font-style:italic">n</span> rows and <span style="font-style:italic">n</span> columns which is obtained by gluing the identity matrix <span style="font-style:italic">I</span><sub><span style="font-style:italic">n</span></sub> and its
negative −<span style="font-style:italic">I</span><sub><span style="font-style:italic">n</span></sub> together:
</p><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell"><span style="font-style:italic">V</span>=</td><td class="dcell"><table class="display"><tr style="vertical-align:middle"><td class="dcell">⎡<br>
⎢<br>
⎣</td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:center;white-space:nowrap" ><span style="font-style:italic">I</span><sub><span style="font-style:italic">n</span></sub></td></tr>
<tr><td style="text-align:center;white-space:nowrap" >−<span style="font-style:italic">I</span><sub><span style="font-style:italic">n</span></sub></td></tr>
</table></td><td class="dcell">⎤<br>
⎥<br>
⎦</td></tr>
</table></td><td class="dcell">. </td></tr>
</table><p>
Since the objective function is convex, the problem can be solved by the Frank-Wolfe method.
Let <span style="font-style:italic">n</span>=10 and <span style="font-style:italic">A</span> be a randomly generated square matrix with coefficients in [−1,1].

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">n</span></span><span style="font-weight:bold"><span style="color:#BF0000">:=10:; </span></span><span style="font-weight:bold"><span style="color:#BF0000">A</span></span><span style="font-weight:bold"><span style="color:#BF0000">:=</span></span><span style="font-weight:bold"><span style="color:#BF0000">ranm</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">n</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">n</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">uniformd</span></span><span style="font-weight:bold"><span style="color:#BF0000">(-1,1)):;</span></span></td></tr>
</table><p>Now let <span style="font-weight:bold"><span style="font-style:italic">y</span></span>∈ℝ<sup><span style="font-style:italic">n</span></sup> be a random point on the sphere with radius <span style="font-style:italic">r</span>=1.1.
Then define <span style="font-weight:bold"><span style="font-style:italic">b</span></span>=<span style="font-style:italic">A</span><span style="font-weight:bold"><span style="font-style:italic">y</span></span>. Thus the global minimum of <span style="font-style:italic">f</span> is located near the polyhedron,
but outside it.

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">:=</span></span><span style="font-weight:bold"><span style="color:#BF0000">ranv</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">n</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">randnorm</span></span><span style="font-weight:bold"><span style="color:#BF0000">):; </span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">:=1.1*</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">/</span></span><span style="font-weight:bold"><span style="color:#BF0000">l2norm</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">):; </span></span><span style="font-weight:bold"><span style="color:#BF0000">b</span></span><span style="font-weight:bold"><span style="color:#BF0000">:=</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">*</span></span><span style="font-weight:bold"><span style="color:#BF0000">tran</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">A</span></span><span style="font-weight:bold"><span style="color:#BF0000">):;</span></span></td></tr>
</table><p>Define <span style="font-style:italic">V</span>, <span style="font-weight:bold"><span style="font-style:italic">x</span></span>, <span style="font-style:italic">f</span> and call <span style="font-family:monospace">frank_wolfe</span>.
You get a vector which depends on the choices of <span style="font-style:italic">A</span> and <span style="font-weight:bold"><span style="font-style:italic">y</span></span>.

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">V</span></span><span style="font-weight:bold"><span style="color:#BF0000">:=</span></span><span style="font-weight:bold"><span style="color:#BF0000">tran</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">augment</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">idn</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">n</span></span><span style="font-weight:bold"><span style="color:#BF0000">),-</span></span><span style="font-weight:bold"><span style="color:#BF0000">idn</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">n</span></span><span style="font-weight:bold"><span style="color:#BF0000">))):;</span></span><span style="font-weight:bold"><span style="color:#BF0000">
 </span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">:=</span></span><span style="font-weight:bold"><span style="color:#BF0000">symbol_array</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#006600"><span style="font-weight:bold"><span style="color:#BF0000">"x"</span></span></span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">n</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">purge</span></span><span style="font-weight:bold"><span style="color:#BF0000">):;</span></span><span style="font-weight:bold"><span style="color:#BF0000">
 </span></span><span style="font-weight:bold"><span style="color:#BF0000">f</span></span><span style="font-weight:bold"><span style="color:#BF0000">:=</span></span><span style="font-weight:bold"><span style="color:#BF0000">simplify</span></span><span style="font-weight:bold"><span style="color:#BF0000">(1/2*</span></span><span style="font-weight:bold"><span style="color:#BF0000">l2norm</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">*</span></span><span style="font-weight:bold"><span style="color:#BF0000">tran</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">A</span></span><span style="font-weight:bold"><span style="color:#BF0000">)-</span></span><span style="font-weight:bold"><span style="color:#BF0000">b</span></span><span style="font-weight:bold"><span style="color:#BF0000">)^2):;</span></span><span style="font-weight:bold"><span style="color:#BF0000">
 </span></span><span style="font-weight:bold"><span style="color:#BF0000">fw</span></span><span style="font-weight:bold"><span style="color:#BF0000">:=</span></span><span style="font-weight:bold"><span style="color:#BF0000">frank_wolfe</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">f</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">V</span></span><span style="font-weight:bold"><span style="color:#BF0000">)</span></span></td></tr>
</table><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">
     

</td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:right;white-space:nowrap" ><table class="display"><tr style="vertical-align:middle"><td class="dcell"><span style="color:#0000CC">
</span></td><td class="dcell"><span style="color:#0000CC">⎡<br>
⎣</span></td><td class="dcell"><span style="color:#0000CC">0.0,0.0,0.08905128279,0.0853981396774,0.0,0.0,0.469342995518,0.0,−0.355655381935,0.0</span></td><td class="dcell"><span style="color:#0000CC">⎤<br>
⎦</span></td></tr>
</table></td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td></tr>
</table></td></tr>
</table><p>
The optimal value of the objective function is:

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">subs</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">f</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">fw</span></span><span style="font-weight:bold"><span style="color:#BF0000">)</span></span></td></tr>
</table><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">
     

</td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:right;white-space:nowrap" ><span style="color:#0000CC">
1.0435553106
</span></td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td></tr>
</table></td></tr>
</table><p>
COBYLA, for instance, returns a weaker solution (see Section <a href="cascmd_en603.html#ssec%3Acobyla">16.3.3</a>),
which is expected since it does not benefit from gradient information:

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">cb</span></span><span style="font-weight:bold"><span style="color:#BF0000">:=</span></span><span style="font-weight:bold"><span style="color:#BF0000">fMin</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">f</span></span><span style="font-weight:bold"><span style="color:#BF0000">,[</span></span><span style="font-weight:bold"><span style="color:#BF0000">l1norm</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">)&lt;=1],</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">,[0.01</span></span><span style="font-weight:bold"><span style="color:#BF0000">$n</span></span><span style="font-weight:bold"><span style="color:#BF0000">],1</span></span><span style="font-weight:bold"><span style="color:#BF0000">e</span></span><span style="font-weight:bold"><span style="color:#BF0000">-4):;</span></span><span style="font-weight:bold"><span style="color:#BF0000">
 </span></span><span style="font-weight:bold"><span style="color:#BF0000">subs</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">f</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">cb</span></span><span style="font-weight:bold"><span style="color:#BF0000">)</span></span></td></tr>
</table><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">
     

</td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:right;white-space:nowrap" ><span style="color:#0000CC">
1.16374646004
</span></td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td></tr>
</table></td></tr>
</table><p>
The strength of the Frank-Wolfe method, besides automatic feasibility,
is its ability to detect whether the objective function value is sufficiently
close to the (unknown) otimal value.</p><h5 id="sec1442" class="paragraph">Non-convex objectives.</h5>
<p>
Suppose that you want to minimize the function <span style="font-style:italic">f</span>(<span style="font-style:italic">x</span>,<span style="font-style:italic">y</span>)=<span style="font-style:italic">x</span>cos(<span style="font-style:italic">y</span>)−<span style="font-style:italic">y</span>sin(<span style="font-style:italic">x</span><sup>2</sup>) inside the
quadrilateral <span style="font-style:italic">Q</span> with vertices (1,1), (1,3), (3,2) and (3,1). The function
<span style="font-style:italic">f</span> has two local minima in <span style="font-style:italic">Q</span>, one of which is global.
To run <span style="font-family:monospace">frank_wolfe</span> from the points
(3/2,3/2) and (5/2,3/2), enter:

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">purge</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">):;</span></span><span style="font-weight:bold"><span style="color:#BF0000">
 </span></span><span style="font-weight:bold"><span style="color:#BF0000">f</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">Q</span></span><span style="font-weight:bold"><span style="color:#BF0000">:=</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">*</span></span><span style="font-weight:bold"><span style="color:#BF0000">cos</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">)-</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">*</span></span><span style="font-weight:bold"><span style="color:#BF0000">sin</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">^2),[[1,1],[1,3],[3,2],[3,1]]:;</span></span><span style="font-weight:bold"><span style="color:#BF0000">
 </span></span><span style="font-weight:bold"><span style="color:#BF0000">ip1</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">ip2</span></span><span style="font-weight:bold"><span style="color:#BF0000">:=[1.5,1.5],[2.5,1.5]:;</span></span><span style="font-weight:bold"><span style="color:#BF0000">
 </span></span><span style="font-weight:bold"><span style="color:#BF0000">min1</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">min2</span></span><span style="font-weight:bold"><span style="color:#BF0000">:=</span></span><span style="font-weight:bold"><span style="color:#BF0000">frank_wolfe</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">f</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">Q</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">ip1</span></span><span style="font-weight:bold"><span style="color:#BF0000">),</span></span><span style="font-weight:bold"><span style="color:#BF0000">frank_wolfe</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">f</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">Q</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">ip2</span></span><span style="font-weight:bold"><span style="color:#BF0000">)</span></span></td></tr>
</table><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">
     

</td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:right;white-space:nowrap" ><table class="display"><tr style="vertical-align:middle"><td class="dcell"><span style="color:#0000CC">
</span></td><td class="dcell"><span style="color:#0000CC">⎡<br>
⎣</span></td><td class="dcell"><span style="color:#0000CC">1.26907401345,2.86473876147</span></td><td class="dcell"><span style="color:#0000CC">⎤<br>
⎦</span></td><td class="dcell"><span style="color:#0000CC">,</span></td><td class="dcell"><span style="color:#0000CC">⎡<br>
⎣</span></td><td class="dcell"><span style="color:#0000CC">2.78442772106,2.10749634066</span></td><td class="dcell"><span style="color:#0000CC">⎤<br>
⎦</span></td></tr>
</table></td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td></tr>
</table></td></tr>
</table><p>
To plot the function <span style="font-style:italic">f</span>, quadrilateral <span style="font-style:italic">Q</span>, initial points and obtained minima, enter:

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">plotdensity</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">f</span></span><span style="font-weight:bold"><span style="color:#BF0000">,[</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">=0.8..3.2,</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">=0.0..3.5]);</span></span><span style="font-weight:bold"><span style="color:#BF0000">
 </span></span><span style="font-weight:bold"><span style="color:#BF0000">polygon</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">op</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">B</span></span><span style="font-weight:bold"><span style="color:#BF0000">),</span></span><span style="font-weight:bold"><span style="color:#BF0000">color</span></span><span style="font-weight:bold"><span style="color:#BF0000">=</span></span><span style="font-weight:bold"><span style="color:#BF0000">line_width_3</span></span><span style="font-weight:bold"><span style="color:#BF0000">+</span></span><span style="font-weight:bold"><span style="color:#BF0000">quadrant4</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">legend</span></span><span style="font-weight:bold"><span style="color:#BF0000">=</span></span><span style="font-weight:bold"><span style="color:#006600"><span style="font-weight:bold"><span style="color:#BF0000">"boundary"</span></span></span></span><span style="font-weight:bold"><span style="color:#BF0000">);</span></span><span style="font-weight:bold"><span style="color:#BF0000">
 </span></span><span style="font-weight:bold"><span style="color:#BF0000">point</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">min1</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">color</span></span><span style="font-weight:bold"><span style="color:#BF0000">=</span></span><span style="font-weight:bold"><span style="color:#BF0000">yellow</span></span><span style="font-weight:bold"><span style="color:#BF0000">+</span></span><span style="font-weight:bold"><span style="color:#BF0000">point_width_2</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">legend</span></span><span style="font-weight:bold"><span style="color:#BF0000">=</span></span><span style="font-weight:bold"><span style="color:#006600"><span style="font-weight:bold"><span style="color:#BF0000">"min1"</span></span></span></span><span style="font-weight:bold"><span style="color:#BF0000">);</span></span><span style="font-weight:bold"><span style="color:#BF0000">
 </span></span><span style="font-weight:bold"><span style="color:#BF0000">point</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">min2</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">color</span></span><span style="font-weight:bold"><span style="color:#BF0000">=</span></span><span style="font-weight:bold"><span style="color:#BF0000">yellow</span></span><span style="font-weight:bold"><span style="color:#BF0000">+</span></span><span style="font-weight:bold"><span style="color:#BF0000">point_width_2</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">legend</span></span><span style="font-weight:bold"><span style="color:#BF0000">=</span></span><span style="font-weight:bold"><span style="color:#006600"><span style="font-weight:bold"><span style="color:#BF0000">"min2"</span></span></span></span><span style="font-weight:bold"><span style="color:#BF0000">);</span></span><span style="font-weight:bold"><span style="color:#BF0000">
 </span></span><span style="font-weight:bold"><span style="color:#BF0000">point</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">ip1</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">legend</span></span><span style="font-weight:bold"><span style="color:#BF0000">=</span></span><span style="font-weight:bold"><span style="color:#006600"><span style="font-weight:bold"><span style="color:#BF0000">"ip1"</span></span></span></span><span style="font-weight:bold"><span style="color:#BF0000">); </span></span><span style="font-weight:bold"><span style="color:#BF0000">point</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">ip2</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">legend</span></span><span style="font-weight:bold"><span style="color:#BF0000">=</span></span><span style="font-weight:bold"><span style="color:#006600"><span style="font-weight:bold"><span style="color:#BF0000">"ip2"</span></span></span></span><span style="font-weight:bold"><span style="color:#BF0000">)</span></span></td></tr>
</table><div class="center">

<img src="cascmd_en026.png">

</div><p>

Points <span style="font-family:monospace">min1</span> and <span style="font-family:monospace">min2</span> are the global and a local minimum, respectively:

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">subs</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">f</span></span><span style="font-weight:bold"><span style="color:#BF0000">,[</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">],</span></span><span style="font-weight:bold"><span style="color:#BF0000">min1</span></span><span style="font-weight:bold"><span style="color:#BF0000">),</span></span><span style="font-weight:bold"><span style="color:#BF0000">subs</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">f</span></span><span style="font-weight:bold"><span style="color:#BF0000">,[</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">],</span></span><span style="font-weight:bold"><span style="color:#BF0000">min2</span></span><span style="font-weight:bold"><span style="color:#BF0000">)</span></span></td></tr>
</table><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">
     

</td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:right;white-space:nowrap" ><span style="color:#0000CC">
−4.08322337291,−3.52045371621
</span></td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td></tr>
</table></td></tr>
</table><p>
The algorithm gets stuck in the local minimum <span style="font-family:monospace">min2</span> when
starting from <span style="font-style:italic">ip</span><sub>2</sub> because it is not allowed to go uphill.
To find the global minimum one must apply multi-start,
which you can select by using the <span style="font-family:monospace">rand</span> option. Indeed:

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">frank_wolfe</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">f</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">Q</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">rand</span></span><span style="font-weight:bold"><span style="color:#BF0000">)</span></span></td></tr>
</table><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">
     

</td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:right;white-space:nowrap" ><table class="display"><tr style="vertical-align:middle"><td class="dcell"><span style="color:#0000CC">
</span></td><td class="dcell"><span style="color:#0000CC">⎡<br>
⎣</span></td><td class="dcell"><span style="color:#0000CC">1.26907407408,2.86474054616</span></td><td class="dcell"><span style="color:#0000CC">⎤<br>
⎦</span></td></tr>
</table></td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td></tr>
</table></td></tr>
</table><p>As another example, <span style="font-family:monospace">frank_wolfe</span> is used to find the global minimum of
the <em>six-hump camel function</em>:
</p><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell"><span style="font-style:italic">f</span>(<span style="font-style:italic">x</span>,<span style="font-style:italic">y</span>)=</td><td class="dcell">⎛<br>
⎜<br>
⎜<br>
⎝</td><td class="dcell">4−2.1<span style="font-style:italic">x</span><sup>2</sup>+</td><td class="dcell"><table class="display"><tr><td class="dcell" style="text-align:center"><span style="font-style:italic">x</span><sup>4</sup></td></tr>
<tr><td class="hbar"></td></tr>
<tr><td class="dcell" style="text-align:center">3</td></tr>
</table></td><td class="dcell">⎞<br>
⎟<br>
⎟<br>
⎠</td><td class="dcell"><span style="font-style:italic">x</span><sup>2</sup>+<span style="font-style:italic">xy</span>+(−4+4<span style="font-style:italic">y</span><sup>2</sup>)<span style="font-style:italic">y</span><sup>2</sup> </td></tr>
</table><p>
in the rectangle [−3,3]×[−2,2]
(see <a href="https://www.sfu.ca/~ssurjano/camel6.html">here</a>).
The function has six local minima, two
of which are global: (0.0898,−0.7126) and (−0.0898,0.7126). Indeed:

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">f</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">R</span></span><span style="font-weight:bold"><span style="color:#BF0000">:=(4-2.1*</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">^2+</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">^4/3)*</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">^2+</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">*</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">+(-4+4*</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">^2)*</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">^2,[[-3,-2],[-3,2],[3,2],[3,-2]]:;</span></span><span style="font-weight:bold"><span style="color:#BF0000">
 </span></span><span style="font-weight:bold"><span style="color:#BF0000">frank_wolfe</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">f</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">R</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">rand</span></span><span style="font-weight:bold"><span style="color:#BF0000">=10000)</span></span></td></tr>
</table><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">
     

</td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:right;white-space:nowrap" ><span style="color:#0000CC">
[0.0898388758644,−0.712673226867]
</span></td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td></tr>
</table></td></tr>
</table><p>
By evaluating the above commandline several times in a row, you always get one
of the two global minima.</p><h5 id="sec1443" class="paragraph">Boundary discretization.</h5>
<p>
When minimizing on a convex domain, you can simplify the problem by discretizing the
domain boundary. For example, minimize
</p><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell"><span style="font-style:italic">f</span>(<span style="font-style:italic">x</span>,<span style="font-style:italic">y</span>)=4<span style="font-style:italic">e</span><sup><span style="font-style:italic">x</span></sup>+5cos<span style="font-style:italic">y</span>−<span style="font-style:italic">x</span><sup>2</sup><span style="font-style:italic">y</span>+4<span style="font-style:italic">x</span>+5<span style="font-style:italic">y</span>−25<span style="font-style:italic">e</span><sup>−(<span style="font-style:italic">x</span>−1)<sup>2</sup>−(<span style="font-style:italic">y</span>−2)<sup>2</sup></sup> </td></tr>
</table><p>
in the convex set <span style="font-style:italic">D</span>⊂ℝ<sup>2</sup> bounded by the closed parametric curve <span style="font-style:italic">C</span> defined by
</p><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell"><span style="font-style:italic">x</span>(<span style="font-style:italic">t</span>)=</td><td class="dcell">⎛<br>
⎜<br>
⎜<br>
⎝</td><td class="dcell">2+cos</td><td class="dcell">⎛<br>
⎜<br>
⎜<br>
⎝</td><td class="dcell"><span style="font-style:italic">t</span>−</td><td class="dcell"><table class="display"><tr><td class="dcell" style="text-align:center">π</td></tr>
<tr><td class="hbar"></td></tr>
<tr><td class="dcell" style="text-align:center">6</td></tr>
</table></td><td class="dcell">⎞<br>
⎟<br>
⎟<br>
⎠</td><td class="dcell">⎞<br>
⎟<br>
⎟<br>
⎠</td><td class="dcell">sin(sin<span style="font-style:italic">t</span>),  
<span style="font-style:italic">y</span>(<span style="font-style:italic">t</span>)=2(2+cos<span style="font-style:italic">t</span>)cos</td><td class="dcell">⎛<br>
⎜<br>
⎜<br>
⎝</td><td class="dcell"><span style="font-style:italic">t</span>+</td><td class="dcell"><table class="display"><tr><td class="dcell" style="text-align:center">π</td></tr>
<tr><td class="hbar"></td></tr>
<tr><td class="dcell" style="text-align:center">6</td></tr>
</table></td><td class="dcell">⎞<br>
⎟<br>
⎟<br>
⎠</td><td class="dcell">,   0≤ <span style="font-style:italic">t</span>≤ 2π. </td></tr>
</table><p>
Let <span style="font-style:italic">A</span>={(<span style="font-style:italic">x</span>(<span style="font-style:italic">t</span><sub><span style="font-style:italic">k</span></sub>),<span style="font-style:italic">y</span>(<span style="font-style:italic">t</span><sub><span style="font-style:italic">k</span></sub>)):<span style="font-style:italic">t</span><sub><span style="font-style:italic">k</span></sub>=2<span style="font-style:italic">k</span>π/<span style="font-style:italic">n</span>,<span style="font-style:italic">k</span>=1,2,…,<span style="font-style:italic">n</span>} for
some <span style="font-style:italic">n</span>≥ 2. Now the convex hull of <span style="font-style:italic">A</span> can be used as an approximation of <span style="font-style:italic">D</span>.
To define <span style="font-style:italic">f</span> and the <span style="font-style:italic">C</span> (with <span style="font-style:italic">u</span> and <span style="font-style:italic">v</span> instead of <span style="font-style:italic">x</span> and <span style="font-style:italic">y</span>), enter:

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">f</span></span><span style="font-weight:bold"><span style="color:#BF0000">:=4*</span></span><span style="font-weight:bold"><span style="color:#BF0000">exp</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">)+5*</span></span><span style="font-weight:bold"><span style="color:#BF0000">cos</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">)-</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">^2*</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">+4</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">+5</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">-25*</span></span><span style="font-weight:bold"><span style="color:#BF0000">exp</span></span><span style="font-weight:bold"><span style="color:#BF0000">(-(</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">-1)^2-(</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">-2)^2):;</span></span><span style="font-weight:bold"><span style="color:#BF0000">
 </span></span><span style="font-weight:bold"><span style="color:#BF0000">u</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">t</span></span><span style="font-weight:bold"><span style="color:#BF0000">):=(2+</span></span><span style="font-weight:bold"><span style="color:#BF0000">cos</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">t</span></span><span style="font-weight:bold"><span style="color:#BF0000">-</span></span><span style="font-weight:bold"><span style="color:#BF0000">pi</span></span><span style="font-weight:bold"><span style="color:#BF0000">/6))*</span></span><span style="font-weight:bold"><span style="color:#BF0000">sin</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">sin</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">t</span></span><span style="font-weight:bold"><span style="color:#BF0000">)):;</span></span><span style="font-weight:bold"><span style="color:#BF0000">
 </span></span><span style="font-weight:bold"><span style="color:#BF0000">v</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">t</span></span><span style="font-weight:bold"><span style="color:#BF0000">):=2*(2+</span></span><span style="font-weight:bold"><span style="color:#BF0000">cos</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">t</span></span><span style="font-weight:bold"><span style="color:#BF0000">))*</span></span><span style="font-weight:bold"><span style="color:#BF0000">cos</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">t</span></span><span style="font-weight:bold"><span style="color:#BF0000">+</span></span><span style="font-weight:bold"><span style="color:#BF0000">pi</span></span><span style="font-weight:bold"><span style="color:#BF0000">/6):;</span></span></td></tr>
</table><p>Now generate the hull vertices with, say, <span style="font-style:italic">n</span>=1000. Since <span style="font-family:monospace">linspace</span> includes both
0 and 2π in <span style="font-family:monospace">s</span>, the former is discarded by using <span style="font-family:monospace">tail</span>.

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">s</span></span><span style="font-weight:bold"><span style="color:#BF0000">:=</span></span><span style="font-weight:bold"><span style="color:#BF0000">evalf</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">tail</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">linspace</span></span><span style="font-weight:bold"><span style="color:#BF0000">(0,2*</span></span><span style="font-weight:bold"><span style="color:#BF0000">pi</span></span><span style="font-weight:bold"><span style="color:#BF0000">,1000))):;</span></span><span style="font-weight:bold"><span style="color:#BF0000">
 </span></span><span style="font-weight:bold"><span style="color:#BF0000">A</span></span><span style="font-weight:bold"><span style="color:#BF0000">:=</span></span><span style="font-weight:bold"><span style="color:#BF0000">tran</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">apply</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">u</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">s</span></span><span style="font-weight:bold"><span style="color:#BF0000">),</span></span><span style="font-weight:bold"><span style="color:#BF0000">apply</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">v</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">s</span></span><span style="font-weight:bold"><span style="color:#BF0000">)):;</span></span></td></tr>
</table><p>Use the <span style="font-family:monospace">rand</span> option when calling <span style="font-family:monospace">frank_wolfe</span> because the function
<span style="font-style:italic">f</span> is not convex has several local minima in <span style="font-style:italic">D</span>.

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">p</span></span><span style="font-weight:bold"><span style="color:#BF0000">:=</span></span><span style="font-weight:bold"><span style="color:#BF0000">frank_wolfe</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">f</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">A</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">rand</span></span><span style="font-weight:bold"><span style="color:#BF0000">)</span></span></td></tr>
</table><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">
     

</td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:right;white-space:nowrap" ><table class="display"><tr style="vertical-align:middle"><td class="dcell"><span style="color:#0000CC">
</span></td><td class="dcell"><span style="color:#0000CC">⎡<br>
⎣</span></td><td class="dcell"><span style="color:#0000CC">0.0565029231227,−1.78083520026</span></td><td class="dcell"><span style="color:#0000CC">⎤<br>
⎦</span></td></tr>
</table></td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td></tr>
</table></td></tr>
</table><p>
To plot the function <span style="font-style:italic">f</span>, curve <span style="font-style:italic">C</span> and point <span style="font-style:italic">p</span>, enter:

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">densityplot</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">f</span></span><span style="font-weight:bold"><span style="color:#BF0000">,[</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">=-2..3,</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">=-3..6]);</span></span><span style="font-weight:bold"><span style="color:#BF0000">
 </span></span><span style="font-weight:bold"><span style="color:#BF0000">paramplot</span></span><span style="font-weight:bold"><span style="color:#BF0000">([</span></span><span style="font-weight:bold"><span style="color:#BF0000">u</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">t</span></span><span style="font-weight:bold"><span style="color:#BF0000">),</span></span><span style="font-weight:bold"><span style="color:#BF0000">v</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">t</span></span><span style="font-weight:bold"><span style="color:#BF0000">)],</span></span><span style="font-weight:bold"><span style="color:#BF0000">t</span></span><span style="font-weight:bold"><span style="color:#BF0000">=0..2</span></span><span style="font-weight:bold"><span style="color:#BF0000">pi</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">display</span></span><span style="font-weight:bold"><span style="color:#BF0000">=</span></span><span style="font-weight:bold"><span style="color:#BF0000">line_width_3</span></span><span style="font-weight:bold"><span style="color:#BF0000">);</span></span><span style="font-weight:bold"><span style="color:#BF0000">
 </span></span><span style="font-weight:bold"><span style="color:#BF0000">point</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">p</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">display</span></span><span style="font-weight:bold"><span style="color:#BF0000">=</span></span><span style="font-weight:bold"><span style="color:#BF0000">point_width_2</span></span><span style="font-weight:bold"><span style="color:#BF0000">+</span></span><span style="font-weight:bold"><span style="color:#BF0000">red</span></span><span style="font-weight:bold"><span style="color:#BF0000">)</span></span></td></tr>
</table><div class="center">

<img src="cascmd_en027.png">

</div><h5 id="sec1444" class="paragraph">Input with functions.</h5>
<p>
In some problems, computing the objective function value and/or its derivative may
be too complex for automatic handling. In such cases you should provide <span style="font-family:monospace">giac</span>
functions which compute these values. For example, suppose you wish to minimize
the function
</p><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell"><span style="font-style:italic">f</span>(<span style="font-style:italic">x</span>,<span style="font-style:italic">y</span>)=−<span style="font-style:italic">Ai</span>(1+<span style="font-style:italic">x</span>)cos</td><td class="dcell">⎛<br>
⎜<br>
⎜<br>
⎝</td><td class="dcell"><span style="font-style:italic">y</span>−</td><td class="dcell"><table class="display"><tr><td class="dcell" style="text-align:center">π</td></tr>
<tr><td class="hbar"></td></tr>
<tr><td class="dcell" style="text-align:center">8</td></tr>
</table></td><td class="dcell">⎞<br>
⎟<br>
⎟<br>
⎠</td><td class="dcell">,   <span style="font-style:italic">x</span>≥ −1, </td></tr>
</table><p>
where Ai is the Airy function of the first kind,
on the domain enclosed by the pentagon with vertices corresponding to complex
solutions of the equation <span style="font-style:italic">z</span><sup>5</sup>=1. To define the boundary, enter:

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">boundary</span></span><span style="font-weight:bold"><span style="color:#BF0000">:=</span></span><span style="font-weight:bold"><span style="color:#BF0000">polygon</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">op</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">cZeros</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">z</span></span><span style="font-weight:bold"><span style="color:#BF0000">^5=1,</span></span><span style="font-weight:bold"><span style="color:#BF0000">z</span></span><span style="font-weight:bold"><span style="color:#BF0000">)),</span></span><span style="font-weight:bold"><span style="color:#BF0000">display</span></span><span style="font-weight:bold"><span style="color:#BF0000">=</span></span><span style="font-weight:bold"><span style="color:#BF0000">quadrant4</span></span><span style="font-weight:bold"><span style="color:#BF0000">)</span></span></td></tr>
</table><div class="center">

<img src="cascmd_en028.png">

</div><p>

To define the objective function, enter:

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">f</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">):=-</span></span><span style="font-weight:bold"><span style="color:#BF0000">Airy_Ai</span></span><span style="font-weight:bold"><span style="color:#BF0000">(1+</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">)*</span></span><span style="font-weight:bold"><span style="color:#BF0000">cos</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">-</span></span><span style="font-weight:bold"><span style="color:#BF0000">pi</span></span><span style="font-weight:bold"><span style="color:#BF0000">/8):;</span></span></td></tr>
</table><p>Computing the gradient of <span style="font-style:italic">f</span> automatically is difficult because the <span style="font-family:monospace">grad</span> command
does not know how to compute the derivative of Ai function, so you will have to provide
the gradient function yourself. By the relation between Airy functions and modified
Bessel functions, you get:
</p><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell"><span style="font-style:italic">Ai</span>′(<span style="font-style:italic">z</span>)=−</td><td class="dcell"><table class="display"><tr><td class="dcell" style="text-align:center"><span style="font-style:italic">z</span></td></tr>
<tr><td class="hbar"></td></tr>
<tr><td class="dcell" style="text-align:center"><table class="display"><tr style="vertical-align:middle"><td class="dcell">π</td><td class="dcell"><span style="font-size:x-large">√</span></td><td class="dcell"><table style="border:0;border-spacing:1;border-collapse:separate;" class="cellpadding0"><tr><td class="hbar"></td></tr>
<tr><td style="text-align:center;white-space:nowrap" >3</td></tr>
</table></td></tr>
</table></td></tr>
</table></td><td class="dcell"><span style="font-style:italic">K</span><sub>2/3</sub>(ζ), </td></tr>
</table><p>
where ζ=2/3<span style="font-style:italic">z</span><sup>3/2</sup> and
</p><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell"><span style="font-style:italic">K</span><sub>ν</sub>(<span style="font-style:italic">z</span>)=</td><td class="dcell"><table class="display"><tr><td class="dcell" style="text-align:center"><table class="display"><tr style="vertical-align:middle"><td class="dcell"><span style="font-size:x-large">√</span></td><td class="dcell"><table style="border:0;border-spacing:1;border-collapse:separate;" class="cellpadding0"><tr><td class="hbar"></td></tr>
<tr><td style="text-align:center;white-space:nowrap" >π</td></tr>
</table></td></tr>
</table></td></tr>
<tr><td class="hbar"></td></tr>
<tr><td class="dcell" style="text-align:center">2<sup>ν</sup>Γ(ν+1/2)</td></tr>
</table></td><td class="dcell"><table class="display"><tr><td class="dcell" style="text-align:center"><span style="font-style:italic">e</span><sup>−<span style="font-style:italic">z</span></sup></td></tr>
<tr><td class="hbar"></td></tr>
<tr><td class="dcell" style="text-align:center"><table class="display"><tr style="vertical-align:middle"><td class="dcell"><span style="font-size:x-large">√</span></td><td class="dcell"><table style="border:0;border-spacing:1;border-collapse:separate;" class="cellpadding0"><tr><td class="hbar"></td></tr>
<tr><td style="text-align:center;white-space:nowrap" ><span style="font-style:italic">z</span></td></tr>
</table></td></tr>
</table></td></tr>
</table></td><td class="dcell">
</td><td class="dcell"><span style="font-size:xx-large">∫</span></td><td class="dcell"><table class="display"><tr><td class="dcell" style="text-align:left">∞</td></tr>
<tr><td class="dcell" style="text-align:left"><br>
<br>
</td></tr>
<tr><td class="dcell" style="text-align:left">0</td></tr>
</table></td><td class="dcell">⎛<br>
⎜<br>
⎜<br>
⎝</td><td class="dcell">2+</td><td class="dcell"><table class="display"><tr><td class="dcell" style="text-align:center"><span style="font-style:italic">t</span></td></tr>
<tr><td class="hbar"></td></tr>
<tr><td class="dcell" style="text-align:center"><span style="font-style:italic">z</span></td></tr>
</table></td><td class="dcell">⎞<br>
⎟<br>
⎟<br>
⎠</td><td class="dcell"><table class="display"><tr><td class="dcell" style="text-align:left">ν−1/2</td></tr>
<tr><td class="dcell" style="text-align:left"><br>
<br>
<br>
</td></tr>
<tr><td class="dcell" style="text-align:left">&nbsp;</td></tr>
</table></td><td class="dcell"><span style="font-style:italic">t</span><sup>ν−1/2</sup><span style="font-style:italic">e</span><sup>−<span style="font-style:italic">t</span></sup><span style="font-style:italic">d</span><span style="font-style:italic">t</span>. </td></tr>
</table><p>
The above integral is easily approximated with Gaussian quadrature for <span style="font-style:italic">z</span>&gt;0 real.
Therefore, the derivative of Ai can be computed for positive arguments by using
the following <span style="font-family:monospace">giac</span> function:

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"> Ai_diff:=<span style="color:#0000CC"><span style="font-weight:bold">proc</span></span>(x)
   <span style="color:#0000CC"><span style="font-weight:bold">local</span></span> zeta,K,K0,t;
   zeta:=2/3*x^(3/2);
   purge(t);
   K0:=exp(-zeta)/(4^(1/3)*Gamma(7/6)*sqrt(zeta));
   K:=K0*int((2t+t^2/zeta)^(1/6)*exp(-t),t=0..inf);
   <span style="color:#0000CC"><span style="font-weight:bold">return</span></span> evalf(-x/sqrt(3*pi)*K);
 <span style="color:#0000CC"><span style="font-weight:bold">end</span></span></td></tr>
</table><p>Now, with some elementary differentiation by hand or by the help of <span style="font-family:monospace">grad</span>,
we get the gradient of <span style="font-style:italic">f</span>:
</p><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">∇ <span style="font-style:italic">f</span>(<span style="font-style:italic">x</span>,<span style="font-style:italic">y</span>)=</td><td class="dcell"><table class="display"><tr style="vertical-align:middle"><td class="dcell">⎡<br>
⎢<br>
⎢<br>
⎢<br>
⎢<br>
⎢<br>
⎢<br>
⎢<br>
⎣</td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:center;white-space:nowrap" ><table class="display"><tr style="vertical-align:middle"><td class="dcell">    −<span style="font-style:italic">Ai</span>′(1+<span style="font-style:italic">x</span>)cos</td><td class="dcell">⎛<br>
⎜<br>
⎜<br>
⎝</td><td class="dcell"><span style="font-style:italic">y</span>−</td><td class="dcell"><table class="display"><tr><td class="dcell" style="text-align:center">π</td></tr>
<tr><td class="hbar"></td></tr>
<tr><td class="dcell" style="text-align:center">8</td></tr>
</table></td><td class="dcell">⎞<br>
⎟<br>
⎟<br>
⎠</td></tr>
</table></td></tr>
<tr><td style="text-align:center;white-space:nowrap" ><table class="display"><tr style="vertical-align:middle"><td class="dcell">    <span style="font-style:italic">Ai</span>(1+<span style="font-style:italic">x</span>)sin</td><td class="dcell">⎛<br>
⎜<br>
⎜<br>
⎝</td><td class="dcell"><span style="font-style:italic">y</span>−</td><td class="dcell"><table class="display"><tr><td class="dcell" style="text-align:center">π</td></tr>
<tr><td class="hbar"></td></tr>
<tr><td class="dcell" style="text-align:center">8</td></tr>
</table></td><td class="dcell">⎞<br>
⎟<br>
⎟<br>
⎠</td></tr>
</table></td></tr>
</table></td><td class="dcell">⎤<br>
⎥<br>
⎥<br>
⎥<br>
⎥<br>
⎥<br>
⎥<br>
⎥<br>
⎦</td></tr>
</table></td><td class="dcell">, </td></tr>
</table><p>
which is computed by the function

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"> g:=<span style="color:#0000CC"><span style="font-weight:bold">proc</span></span>(x,y)
   <span style="color:#0000CC"><span style="font-weight:bold">return</span></span> evalf([-Ai_diff(x+1)*cos(y-pi/8),Airy_Ai(x+1)*sin(y-pi/8)]);
 <span style="color:#0000CC"><span style="font-weight:bold">end</span></span></td></tr>
</table><p>To get the coordinates of pentagon vertices, enter
(note the conversion to floating-point values):

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">  </span></span><span style="font-weight:bold"><span style="color:#BF0000">A</span></span><span style="font-weight:bold"><span style="color:#BF0000">:=</span></span><span style="font-weight:bold"><span style="color:#BF0000">evalf</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">coordinates</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">vertices</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">boundary</span></span><span style="font-weight:bold"><span style="color:#BF0000">)))</span></span></td></tr>
</table><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">
     

</td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:right;white-space:nowrap" ><table class="display"><tr style="vertical-align:middle"><td class="dcell"><span style="color:#0000CC">
</span></td><td class="dcell"><span style="color:#0000CC">⎡<br>
⎢<br>
⎢<br>
⎢<br>
⎢<br>
⎢<br>
⎣</span></td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">0.309016994375</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">−0.951056516295</span></td></tr>
<tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">−0.809016994375</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">−0.587785252292</span></td></tr>
<tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">−0.809016994375</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">0.587785252292</span></td></tr>
<tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">0.309016994375</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">0.951056516295</span></td></tr>
<tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">1.0</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">0.0</span></td></tr>
</table></td><td class="dcell"><span style="color:#0000CC">⎤<br>
⎥<br>
⎥<br>
⎥<br>
⎥<br>
⎥<br>
⎦</span></td></tr>
</table></td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td></tr>
</table></td></tr>
</table><p>
Now find the minimum of <span style="font-style:italic">f</span> inside the pentagon:

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">frank_wolfe</span></span><span style="font-weight:bold"><span style="color:#BF0000">([</span></span><span style="font-weight:bold"><span style="color:#BF0000">f</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">g</span></span><span style="font-weight:bold"><span style="color:#BF0000">],</span></span><span style="font-weight:bold"><span style="color:#BF0000">evalf</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">coordinates</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">vertices</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">p</span></span><span style="font-weight:bold"><span style="color:#BF0000">))))</span></span></td></tr>
</table><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">
     

</td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:right;white-space:nowrap" ><table class="display"><tr style="vertical-align:middle"><td class="dcell"><span style="color:#0000CC">
</span></td><td class="dcell"><span style="color:#0000CC">⎡<br>
⎣</span></td><td class="dcell"><span style="color:#0000CC">−0.809016994375,0.393184912674</span></td><td class="dcell"><span style="color:#0000CC">⎤<br>
⎦</span></td></tr>
</table></td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td></tr>
</table></td></tr>
</table><p>
Indeed:

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">plotdensity</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">f</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">),[</span></span><span style="font-weight:bold"><span style="color:#BF0000">x</span></span><span style="font-weight:bold"><span style="color:#BF0000">=-1..1,</span></span><span style="font-weight:bold"><span style="color:#BF0000">y</span></span><span style="font-weight:bold"><span style="color:#BF0000">=-1..1]);</span></span><span style="font-weight:bold"><span style="color:#BF0000">
 </span></span><span style="font-weight:bold"><span style="color:#BF0000">display</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">boundary</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">line_width_2</span></span><span style="font-weight:bold"><span style="color:#BF0000">);</span></span><span style="font-weight:bold"><span style="color:#BF0000">
 </span></span><span style="font-weight:bold"><span style="color:#BF0000">point</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">p</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">display</span></span><span style="font-weight:bold"><span style="color:#BF0000">=</span></span><span style="font-weight:bold"><span style="color:#BF0000">point_width_2</span></span><span style="font-weight:bold"><span style="color:#BF0000">+</span></span><span style="font-weight:bold"><span style="color:#BF0000">red</span></span><span style="font-weight:bold"><span style="color:#BF0000">)</span></span></td></tr>
</table><div class="center">

<img src="cascmd_en029.png">

</div><p>

Note that using the <span style="font-family:monospace">rand</span> option in this case would also require
a function which computes the Hessian of <span style="font-style:italic">f</span> at a given point.</p>
<hr>
<a href="cascmd_en601.html"><img src="previous_motif.gif" alt="Previous"></a>
<a href="index.html"><img src="contents_motif.gif" alt="Up"></a>
<a href="cascmd_en603.html"><img src="next_motif.gif" alt="Next"></a>
</body>
</html>
