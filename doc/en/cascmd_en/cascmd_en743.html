<!DOCTYPE html>
<html >
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="hevea 2.29+5 of 2017-05-18">
<link rel="stylesheet" type="text/css" href="cascmd_en.css">
<title>Hierarchical clustering</title>
</head>
<body >
<a href="cascmd_en741.html"><img src="previous_motif.gif" alt="Previous"></a>
<a href="index.html"><img src="contents_motif.gif" alt="Up"></a>
<a href="cascmd_en744.html"><img src="next_motif.gif" alt="Next"></a>
<hr>
<h3 id="sec:hclust" class="subsection">21.1.1  Hierarchical clustering</h3>
<p>The <span style="font-family:monospace">cluster</span><a id="hevea_default1468"></a>
command is used for hierarchical agglomerative clustering
of custom data by using a custom distance function.</p><ul class="itemize"><li class="li-itemize">
<span style="font-family:monospace">cluster</span> takes one or more arguments:
<ul class="itemize"><li class="li-itemize">
<span style="font-style:italic">data</span>, a list of data points.
</li><li class="li-itemize">Optionally, <span style="font-style:italic">opt</span>, a sequence of options which may contain the following:
<ul class="itemize"><li class="li-itemize">
<span style="font-style:italic">k</span> or <span style="font-family:monospace">count=</span><span style="font-style:italic">k</span>, where <span style="font-style:italic">k</span> is a positive integer
specifying the number of clusters (unset by default).
</li><li class="li-itemize"><span style="font-family:monospace">count_inf=</span><span style="font-style:italic">k</span><sub><span style="font-style:italic">l</span></sub>, where <span style="font-style:italic">k</span><sub><span style="font-style:italic">l</span></sub> is a positive integer specifying the
minimal number of clusters (unset by default).
</li><li class="li-itemize"><span style="font-family:monospace">count_sup=</span><span style="font-style:italic">k</span><sub><span style="font-style:italic">u</span></sub>, where <span style="font-style:italic">k</span><sub><span style="font-style:italic">u</span></sub> is a positive integer specifying the
maximal number of clusters (by default, <span style="font-style:italic">k</span><sub><span style="font-style:italic">u</span></sub>=16).
</li><li class="li-itemize"><span style="font-family:monospace">type=</span><span style="font-style:italic">linkage</span>, where <span style="font-style:italic">linkage</span> is a string specifying
the linkage method. Avaliable methods are:
<span style="font-family:monospace">single</span> (the default), <span style="font-family:monospace">complete</span>, <span style="font-family:monospace">average</span>, <span style="font-family:monospace">weighted</span>,
and <span style="font-family:monospace">ward</span>.
</li><li class="li-itemize"><span style="font-family:monospace">distance=</span><span style="font-style:italic">dist</span>, where <span style="font-style:italic">dist</span> is a distance function. By default,
the squared Euclidean distance function <span style="font-family:monospace">distance2</span> is used unless <span style="font-style:italic">data</span>
is a list of strings, in which case Levenshtein distance is used.
For example, the taxicab distance function could be defined by typing:<a id="hevea_default1469"></a>

<table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">taxicab</span></span><span style="font-weight:bold"><span style="color:#BF0000">:=(</span></span><span style="font-weight:bold"><span style="color:#BF0000">p1</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">p2</span></span><span style="font-weight:bold"><span style="color:#BF0000">)-&gt;</span></span><span style="font-weight:bold"><span style="color:#BF0000">l1norm</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">p1</span></span><span style="font-weight:bold"><span style="color:#BF0000">-</span></span><span style="font-weight:bold"><span style="color:#BF0000">p2</span></span><span style="font-weight:bold"><span style="color:#BF0000">)</span></span></td></tr>
</table></li><li class="li-itemize"><span style="font-family:monospace">index=</span><span style="font-style:italic">ind</span>, where <span style="font-style:italic">ind</span> is a string or a list of strings
specifying the index function(s) used for selecting the optimal number of clusters (unset by default).
Available index functions are:
<span style="font-family:monospace">silhouette</span>, <span style="font-family:monospace">mcclain-rao</span>, <span style="font-family:monospace">dunn</span>, and <span style="font-family:monospace">all</span>.
<span style="font-style:italic">ind</span> may also take a boolean value, in which case no index is used
(<span style="font-style:italic">ind</span><span style="font-family:monospace">=false</span>) or the silhouette index is used (<span style="font-style:italic">ind</span><span style="font-family:monospace">=true</span>).
</li><li class="li-itemize"><span style="font-family:monospace">output=</span><span style="font-style:italic">out</span>, where <span style="font-style:italic">out</span> is one of the following:
<ul class="itemize"><li class="li-itemize">
<span style="font-family:monospace">part</span>, for outputting the partition of data into clusters.
</li><li class="li-itemize"><span style="font-family:monospace">list</span>, for outputting the list of cluster indices for data points (the default).
</li><li class="li-itemize"><span style="font-family:monospace">plot</span>, for outputting a colored visualization of data points with additional
specifications given in <span style="font-family:monospace">display</span> option (see below). Note that this is possible only with
two- and three-dimensional numerical data.
</li><li class="li-itemize"><span style="font-family:monospace">count</span>, for outputting only the number of clusters.
</li><li class="li-itemize"><span style="font-family:monospace">index</span>, for outputting the list of values of the (first) used index.
</li><li class="li-itemize"><span style="font-family:monospace">tree</span>, for outputting a dendrogram drawing which visualizes the linking process.
</li></ul>
</li><li class="li-itemize"><span style="font-family:monospace">display=</span><span style="font-style:italic">disp</span>, where <span style="font-style:italic">disp</span> is a configuration for plot output
(by default, points are drawn as dots of width 2).
</li><li class="li-itemize"><span style="font-family:monospace">color=</span><span style="font-style:italic">colors</span>, where <span style="font-style:italic">colors</span> is a list of colors that will be used
for cluster coloring in the plot output mode (by default, the standard palette of first 16 colors
is used, with white and yellow replaced by more visible colors).
</li><li class="li-itemize"><span style="font-family:monospace">labels=</span><span style="font-style:italic">lab</span>, where <span style="font-style:italic">lab</span> is a boolean value which specifies
whether to show data points in the dendrogram.
</li></ul>
</li></ul>
</li><li class="li-itemize"><span style="font-family:monospace">cluster(</span><span style="font-style:italic">data</span> ⟨,<span style="font-style:italic">opt</span> ⟩<span style="font-family:monospace">)</span> returns
the result as specified by the <span style="font-family:monospace">output</span> argument (see above).
</li><li class="li-itemize">Hierarchical clustering is slower than the <span style="font-style:italic">k</span>-means algorithm (see Section <a href="cascmd_en744.html#sec%3Akmeans">21.1.2</a>)
but may produce a better classification of the data. Hierarchical clustering is also a method of
choice for custom data types and distance functions.
</li><li class="li-itemize">If more than one index is computed in a clustering process, then the optimal number of clusters
is decided by voting: the number which was selected by most indices is used.
</li></ul><h4 id="sec1905" class="subsubsection">Examples</h4>
<p>
We apply <span style="font-family:monospace">cluster</span> command to an “aggregation”
shape dataset (see <a href="http://cs.joensuu.fi/sipu/datasets/">here</a>).
The dataset is loaded from file in a table cell in <span style="font-variant:small-caps">Xcas</span> and associated with
the variable <span style="font-family:monospace">data</span>. We use the <span style="font-family:monospace">average</span> linkage method and <span style="font-family:monospace">silhouette</span>
index (which is used by default if <span style="font-family:monospace">index=true</span>). By setting <span style="font-family:monospace">output</span> parameter
to <span style="font-family:monospace">plot</span>, we obtain a visualization of colored clusters as shown in Figure <a href="#fig%3Ahclust">21.1</a>.
</p><blockquote class="figure"><div class="center"><div class="center"><hr style="width:80%;height:2"></div>
<img src="cascmd_en198.png">

<div class="caption"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="vertical-align:top;text-align:left;" >Figure 21.1: <a id="fig:hclust"></a>Clustering in <span style="font-variant:small-caps">Xcas</span></td></tr>
</table></div>
<div class="center"><hr style="width:80%;height:2"></div></div></blockquote><p>For string data, Levenshtein distance is used by default (see Section <a href="cascmd_en101.html#sec%3Alevensthein">5.2.16</a>).

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">cluster</span></span><span style="font-weight:bold"><span style="color:#BF0000">([</span></span><span style="font-weight:bold"><span style="color:#006600"><span style="font-weight:bold"><span style="color:#BF0000">"cat"</span></span></span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#006600"><span style="font-weight:bold"><span style="color:#BF0000">"mouse"</span></span></span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#006600"><span style="font-weight:bold"><span style="color:#BF0000">"rat"</span></span></span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#006600"><span style="font-weight:bold"><span style="color:#BF0000">"spouse"</span></span></span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#006600"><span style="font-weight:bold"><span style="color:#BF0000">"house"</span></span></span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#006600"><span style="font-weight:bold"><span style="color:#BF0000">"cut"</span></span></span></span><span style="font-weight:bold"><span style="color:#BF0000">],</span></span><span style="font-weight:bold"><span style="color:#BF0000">output</span></span><span style="font-weight:bold"><span style="color:#BF0000">=</span></span><span style="font-weight:bold"><span style="color:#BF0000">part</span></span><span style="font-weight:bold"><span style="color:#BF0000">)</span></span></td></tr>
</table><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">
     

</td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:right;white-space:nowrap" ><table class="display"><tr style="vertical-align:middle"><td class="dcell"><span style="color:#0000CC">
</span></td><td class="dcell"><table class="display"><tr style="vertical-align:middle"><td class="dcell"><span style="color:#0000CC">⎡<br>
⎢<br>
⎣</span></td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">    </span><span style="color:#0000CC">“cat”</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">“rat”</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">“cut”</span></td></tr>
<tr><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">    </span><span style="color:#0000CC">“mouse”</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">“spouse”</span></td><td style="text-align:center;white-space:nowrap" ><span style="color:#0000CC">“house”</span><span style="color:#0000CC">
</span></td></tr>
</table></td><td class="dcell"><span style="color:#0000CC">⎤<br>
⎥<br>
⎦</span></td></tr>
</table></td></tr>
</table></td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td></tr>
</table></td></tr>
</table><p>In the following example we split genomic sequences into three clusters
by using the <span style="font-family:monospace">average</span> linkage and Hamming distance function.

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">data</span></span><span style="font-weight:bold"><span style="color:#BF0000">:=[</span></span><span style="font-weight:bold"><span style="color:#006600"><span style="font-weight:bold"><span style="color:#BF0000">"GTCTT"</span></span></span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#006600"><span style="font-weight:bold"><span style="color:#BF0000">"AAGCT"</span></span></span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#006600"><span style="font-weight:bold"><span style="color:#BF0000">"GGTAA"</span></span></span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#006600"><span style="font-weight:bold"><span style="color:#BF0000">"AGGCT"</span></span></span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#006600"><span style="font-weight:bold"><span style="color:#BF0000">"GTCAT"</span></span></span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#006600"><span style="font-weight:bold"><span style="color:#BF0000">"CGGCC"</span></span></span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">
 </span></span><span style="font-weight:bold"><span style="color:#006600"><span style="font-weight:bold"><span style="color:#BF0000">"GGGAG"</span></span></span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#006600"><span style="font-weight:bold"><span style="color:#BF0000">"GTTAT"</span></span></span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#006600"><span style="font-weight:bold"><span style="color:#BF0000">"GTCAT"</span></span></span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#006600"><span style="font-weight:bold"><span style="color:#BF0000">"AGGCT"</span></span></span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#006600"><span style="font-weight:bold"><span style="color:#BF0000">"GTCAG"</span></span></span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#006600"><span style="font-weight:bold"><span style="color:#BF0000">"AGGAT"</span></span></span></span><span style="font-weight:bold"><span style="color:#BF0000">]:;</span></span><span style="font-weight:bold"><span style="color:#BF0000">
 </span></span><span style="font-weight:bold"><span style="color:#BF0000">cluster</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">data</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">type</span></span><span style="font-weight:bold"><span style="color:#BF0000">=</span></span><span style="font-weight:bold"><span style="color:#006600"><span style="font-weight:bold"><span style="color:#BF0000">"average"</span></span></span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">count</span></span><span style="font-weight:bold"><span style="color:#BF0000">=3,</span></span><span style="font-weight:bold"><span style="color:#BF0000">distance</span></span><span style="font-weight:bold"><span style="color:#BF0000">=</span></span><span style="font-weight:bold"><span style="color:#BF0000">hamdist</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">output</span></span><span style="font-weight:bold"><span style="color:#BF0000">=</span></span><span style="font-weight:bold"><span style="color:#BF0000">part</span></span><span style="font-weight:bold"><span style="color:#BF0000">)</span></span></td></tr>
</table><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">
     

</td><td class="dcell"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:right;white-space:nowrap" ><span style="color:#0000CC">
[</span></td><td style="text-align:left;white-space:nowrap" ><table class="display"><tr style="vertical-align:middle"><td class="dcell">⎡<br>
⎣</td><td class="dcell">“GTCTT”,“GTCAT”,“GTTAT”,“GTCAT”,“GTCAG”</td><td class="dcell">⎤<br>
⎦</td><td class="dcell">,</td></tr>
</table></td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td></tr>
<tr><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" ><table class="display"><tr style="vertical-align:middle"><td class="dcell">⎡<br>
⎣</td><td class="dcell">“AAGCT”,“AGGCT”,“CGGCC”,“AGGCT”,“AGGAT”</td><td class="dcell">⎤<br>
⎦</td><td class="dcell">,</td></tr>
</table></td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td></tr>
<tr><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" ><table class="display"><tr style="vertical-align:middle"><td class="dcell">⎡<br>
⎣</td><td class="dcell">“GGTAA”,“GGGAG”</td><td class="dcell">⎤<br>
⎦</td><td class="dcell">]
</td></tr>
</table></td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td><td style="text-align:left;white-space:nowrap" >&nbsp;</td><td style="text-align:right;white-space:nowrap" >&nbsp;</td></tr>
</table></td></tr>
</table><p>
To display the dendrogram, enter:

</p><table class="lstframe" style="padding:1ex;border-style:none;"><tr><td class="lstlisting"><span style="font-weight:bold"><span style="color:#BF0000"> </span></span><span style="font-weight:bold"><span style="color:#BF0000">cluster</span></span><span style="font-weight:bold"><span style="color:#BF0000">(</span></span><span style="font-weight:bold"><span style="color:#BF0000">data</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">type</span></span><span style="font-weight:bold"><span style="color:#BF0000">=</span></span><span style="font-weight:bold"><span style="color:#006600"><span style="font-weight:bold"><span style="color:#BF0000">"average"</span></span></span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">count</span></span><span style="font-weight:bold"><span style="color:#BF0000">=3,</span></span><span style="font-weight:bold"><span style="color:#BF0000">distance</span></span><span style="font-weight:bold"><span style="color:#BF0000">=</span></span><span style="font-weight:bold"><span style="color:#BF0000">hamdist</span></span><span style="font-weight:bold"><span style="color:#BF0000">,</span></span><span style="font-weight:bold"><span style="color:#BF0000">output</span></span><span style="font-weight:bold"><span style="color:#BF0000">=</span></span><span style="font-weight:bold"><span style="color:#BF0000">tree</span></span><span style="font-weight:bold"><span style="color:#BF0000">)</span></span></td></tr>
</table><div class="center">

<img src="cascmd_en199.png">

</div>
<hr>
<a href="cascmd_en741.html"><img src="previous_motif.gif" alt="Previous"></a>
<a href="index.html"><img src="contents_motif.gif" alt="Up"></a>
<a href="cascmd_en744.html"><img src="next_motif.gif" alt="Next"></a>
</body>
</html>
