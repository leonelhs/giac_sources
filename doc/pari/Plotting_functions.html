<HTML>
<HEAD>
  <TITLE>
    Catalogue of GP/PARI Functions: Plotting functions
  </TITLE>

  <META NAME="author"       CONTENT="Nils-Peter Skoruppa">
  <META NAME="created"      CONTENT="Thu Apr 27 10:11:36 2006">
  <META NAME="author-email" CONTENT="skoruppa@math.uni-siegen.de">
  <META NAME="keywords"     CONTENT="PARI, GP, DOC">
</HEAD>
<BODY bgcolor="#FFFFFF">



<h3 align=center>Plotting functions</h3>

<a name="High-level plotting functions"></a>
<h4><b>High-level plotting functions</b> (all the functions starting with <font color=#a3682a><tt>
ploth</tt></font>)</h4>
<p></p>
<p> in which the user has little to
do but explain what type of plot he wants, and whose syntax is similar to the
one used in the preceding section.</p>

<br>
<hr></hr><br>

<a name="Low-level plotting functions"></a>
<h4><b>Low-level plotting functions</b> (called <u>rectplot</u> functions,
sharing the prefix <font color=#a3682a><tt>
plot</tt></font>)</h4>
<p></p>
<p>, where every drawing primitive (point, line,
box, etc.) is specified by the user. These low-level functions work as
follows. You have at your disposal 16 virtual windows which are filled
independently, and can then be physically ORed on a single window at
user-defined positions. These windows are numbered from 0 to 15, and must be
initialized before being used by the function <font color=#a3682a><tt>
plotinit</tt></font>, which specifies
the height and width of the virtual window (called a <u>rectwindow</u> in the
sequel). At all times, a virtual cursor (initialized at [0,0]) is associated
to the window, and its current value can be obtained using the function
<font color=#a3682a><tt>
plotcursor</tt></font>.</p>
<p>A number of primitive graphic objects (called <u>rect</u> objects) can then
be drawn in these windows, using a default color associated to that window
(which can be changed under X11, using the <font color=#a3682a><tt>
plotcolor</tt></font> function, black
otherwise) and only the part of the object which is inside the window will be
drawn, with the exception of polygons and strings which are drawn entirely.
The ones sharing the prefix <font color=#a3682a><tt>
plotr</tt></font> draw relatively to the current
position of the virtual cursor, the others use absolute coordinates. Those
having the prefix <font color=#a3682a><tt>
plotrecth</tt></font> put in the rectwindow a large batch of rect
objects corresponding to the output of the related <font color=#a3682a><tt>
ploth</tt></font> function.</p>
<p>   Finally, the actual physical drawing is done using the function
<font color=#a3682a><tt>
plotdraw</tt></font>. The rectwindows are preserved so that further drawings
using the same windows at different positions or different windows can be
done without extra work. To erase a window (and free the corresponding
memory), use the function <font color=#a3682a><tt>
plotkill</tt></font>. It is not possible to partially
erase a window. Erase it completely, initialize it again and then fill it with
the graphic objects that you want to keep.</p>
<p>   In addition to initializing the window, you may use a scaled
window to avoid unnecessary conversions. For this, use the function
<font color=#a3682a><tt>
plotscale</tt></font> below. As long as this function is not called, the scaling is
simply the number of pixels, the origin being at the upper left and the
y-coordinates going downwards.</p>
<p>   Note that in the present version <b>2.2.13</b> all plotting functions (both low
and high level) are written for the X11-window system (hence also for GUI's
based on X11 such as Openwindows and Motif) only, though little code
remains which is actually platform-dependent. It is also possible to compile
<font color=#a3682a><tt>
gp</tt></font> with either of the Qt or FLTK graphical libraries. A
Suntools/Sunview, Macintosh, and an Atari/Gem port were provided for previous
versions, but are now obsolete.</p>
<p>   Under X11, the physical window (opened by <font color=#a3682a><tt>
plotdraw</tt></font> or any of the
<font color=#a3682a><tt>
ploth*</tt></font> functions) is completely separated from <font color=#a3682a><tt>
gp</tt></font> (technically, a
<font color=#a3682a><tt>
fork</tt></font> is done, and the non-graphical memory is immediately freed in the
child process), which means you can go on working in the current <font color=#a3682a><tt>
gp</tt></font>
session, without having to kill the window first. Under X11, this window can
be closed, enlarged or reduced using the standard window manager functions.
No zooming procedure is implemented though (yet).</p>

<br>
<hr></hr><br>

<a name="Functions for PostScript output:"></a>
<h4><b>Functions for PostScript output</h4>
<p></b></p>
<p> in the same way that <font color=#a3682a><tt>
printtex</tt></font> allows you to have a TeX output
corresponding to printed results, the functions starting with <font color=#a3682a><tt>
ps</tt></font> allow
you to have <font color=#a3682a><tt>
PostScript</tt></font> output of the plots. This will not be absolutely
identical with the screen output, but will be sufficiently close. Note that
you can use PostScript output even if you do not have the plotting routines
enabled. The PostScript output is written in a file whose name is derived from
the <font color=#a3682a><tt>
psfile</tt></font> default (<font color=#a3682a><tt>
./pari.ps</tt></font> if you did not tamper with it). Each
time a new PostScript output is asked for, the PostScript output is appended
to that file. Hence you probably want to remove this file, or change the value
of <font color=#a3682a><tt>
psfile</tt></font>, in between plots. On the other hand, in this manner, as many
plots as desired can be kept in a single file. </p>

<br>
<hr></hr><br>

<a name="And library mode ?"></a>
<h4><b>And library mode ?</b></h4>
<p></p>
<p> <u>None of the graphic functions are available
within the PARI library, you must be under <font color=#a3682a><tt>
gp</tt></font> to use them</u>. The reason
for that is that you really should not use PARI for heavy-duty graphical work,
there are better specialized alternatives around. This whole set of routines
was only meant as a convenient, but simple-minded, visual aid. If you really
insist on using these in your program (we warned you), the source
(<font color=#a3682a><tt>
plot*.c</tt></font>) should be readable enough for you to achieve something.</p>

<br>
<hr></hr><br>

<a name="plot"></a>
<h4><b>plot</b>(X = a,b,<u>expr</u>,{<u>Ymin</u>},{<u>Ymax</u>})</h4>
<p></p>
<p> crude
ASCII plot of the function represented by expression <u>expr</u> from
a to b, with <u>Y</u> ranging from <u>Ymin</u> to <u>Ymax</u>. If
<u>Ymin</u> (resp. <u>Ymax</u>) is not given, the minima (resp. the
maxima) of the computed values of the expression is used instead.</p>

<br>
<hr></hr><br>

<a name="plotbox"></a>
<h4><b>plotbox</b>(w,x2,y2)</h4>
<p></p>
<p> let (x1,y1) be the current position of the
virtual cursor. Draw in the rectwindow w the outline of the rectangle which
is such that the points (x1,y1) and (x2,y2) are opposite corners. Only
the part of the rectangle which is in w is drawn. The virtual cursor does
<u>not</u> move.</p>

<br>
<hr></hr><br>

<a name="plotclip"></a>
<h4><b>plotclip</b>(w)</h4>
<p></p>
<p> `clips' the content of rectwindow w, i.e
remove all parts of the drawing that would not be visible on the screen.
Together with <font color=#a3682a><tt>
plotcopy</tt></font> this function enables you to draw on a
scratchpad before commiting the part you're interested in to the final
picture.</p>

<br>
<hr></hr><br>

<a name="plotcolor"></a>
<h4><b>plotcolor</b>(w,c)</h4>
<p></p>
<p> set default color to c in rectwindow w.
In present version <b>2.2.13</b>, this is only implemented for the X11 window system,
and you only have the following palette to choose from:</p>
<p>1 = black, 2 = blue, 3 = sienna, 4 = red, 5 = green, 6 = grey, 7 = gainsborough.</p>
<p>Note that it should be fairly easy for you to hardwire some more colors by
tweaking the files <font color=#a3682a><tt>
rect.h</tt></font> and <font color=#a3682a><tt>
plotX.c</tt></font>. User-defined
colormaps would be nice, and <u>may</u> be available in future versions.</p>

<br>
<hr></hr><br>

<a name="plotcopy"></a>
<h4><b>plotcopy</b>(w1,w2,dx,dy)</h4>
<p></p>
<p> copy the contents of rectwindow
w1 to rectwindow w2, with offset (dx,dy).</p>

<br>
<hr></hr><br>

<a name="plotcursor"></a>
<h4><b>plotcursor</b>(w)</h4>
<p></p>
<p> give as a 2-component vector the current
(scaled) position of the virtual cursor corresponding to the rectwindow w.</p>

<br>
<hr></hr><br>

<a name="plotdraw"></a>
<h4><b>plotdraw</b>(list)</h4>
<p></p>
<p> physically draw the rectwindows given in list
which must be a vector whose number of components is divisible by 3. If
list = [w1,x1,y1,w2,x2,y2,...], the windows w1, w2, etc.are
physically placed with their upper left corner at physical position
(x1,y1), (x2,y2),...respectively, and are then drawn together.
Overlapping regions will thus be drawn twice, and the windows are considered
transparent. Then display the whole drawing in a special window on your
screen.</p>

<br>
<hr></hr><br>

<a name="ploth"></a>
<h4><b>ploth</b>(X = a,b,<u>expr</u>,{<u>flag</u> = 0},{n = 0})</h4>
<p></p>
<p> high precision
plot of the function y = f(x) represented by the expression <u>expr</u>, x
going from a to b. This opens a specific window (which is killed
whenever you click on it), and returns a four-component vector giving the
coordinates of the bounding box in the form
[<u>xmin</u>,<u>xmax</u>,<u>ymin</u>,<u>ymax</u>].</p>
<p><b>Important note</b>: Since this may involve a lot of function calls,
it is advised to keep the current precision to a minimum (e.g.9) before
calling this function.</p>
<p>n specifies the number of reference point on the graph (0 means use the
hardwired default values, that is: 1000 for general plot, 1500 for
parametric plot, and 15 for recursive plot).</p>
<p>If no <u>flag</u> is given, <u>expr</u> is either a scalar expression f(X), in which
case the plane curve y = f(X) will be drawn, or a vector
[f_1(X),...,f_k(X)], and then all the curves y = f_i(X) will be drawn in
the same window.</p>
<p>The binary digits of <u>flag</u> mean:</p>
<p><b>*</b> 1 = <font color=#a3682a><tt>
Parametric</tt></font>: <u>parametric plot</u>. Here <u>expr</u> must
be a vector with an even number of components. Successive pairs are then
understood as the parametric coordinates of a plane curve. Each of these are
then drawn.</p>
<p>For instance:</p>
<p><font color=#a3682a><tt>
ploth(X = 0,2*Pi,[sin(X),cos(X)],1)</tt></font> will draw a circle.</p>
<p><font color=#a3682a><tt>
ploth(X = 0,2*Pi,[sin(X),cos(X)])</tt></font> will draw two entwined sinusoidal
curves.</p>
<p><font color=#a3682a><tt>
ploth(X = 0,2*Pi,[X,X,sin(X),cos(X)],1)</tt></font> will draw a circle and the line
y = x.</p>
<p><b>*</b> 2 = <font color=#a3682a><tt>
Recursive</tt></font>: <u>recursive plot</u>. If this flag is set,
only <u>one</u> curve can be drawn at a time, i.e.<u>expr</u> must be either a
two-component vector (for a single parametric curve, and the parametric flag
<u>has</u> to be set), or a scalar function. The idea is to choose pairs of
successive reference points, and if their middle point is not too far away
from the segment joining them, draw this as a local approximation to the
curve. Otherwise, add the middle point to the reference points. This is
fast, and usually more precise than usual plot. Compare the results of
<font color=#a3682a><tt>
ploth(X = -1,1,sin(1/X),2)</tt></font>  
 {and}  <font color=#a3682a><tt>
ploth(X = -1,1,sin(1/X))</tt></font>
for instance. But beware that if you are extremely unlucky, or choose too few
reference points, you may draw some nice polygon bearing little resemblance
to the original curve. For instance you should <u>never</u> plot recursively
an odd function in a symmetric interval around 0. Try</p>
<p><pre><font color=#a3682a><tt>  ploth(x = -20, 20, sin(x), 2)
</tt></font></pre></p>
<p>to see why. Hence, it's usually a good idea to try and plot the same curve
with slightly different parameters.</p>
<p>The other values toggle various display options:</p>
<p><b>*</b> 4 = <font color=#a3682a><tt>
no_Rescale</tt></font>: do not rescale plot according to the
computed extrema. This is meant to be used when graphing multiple functions
on a rectwindow (as a <font color=#a3682a><tt>
plotrecth</tt></font> call), in conjunction with
<font color=#a3682a><tt>
plotscale</tt></font>.</p>
<p><b>*</b> 8 = <font color=#a3682a><tt>
no_X_axis</tt></font>: do not print the x-axis.</p>
<p><b>*</b> 16 = <font color=#a3682a><tt>
no_Y_axis</tt></font>: do not print the y-axis.</p>
<p><b>*</b> 32 = <font color=#a3682a><tt>
no_Frame</tt></font>: do not print frame.</p>
<p><b>*</b> 64 = <font color=#a3682a><tt>
no_Lines</tt></font>: only plot reference points, do not join them.</p>
<p><b>*</b> 128 = <font color=#a3682a><tt>
Points_too</tt></font>: plot both lines and points.</p>
<p><b>*</b> 256 = <font color=#a3682a><tt>
Splines</tt></font>: use splines to interpolate the points.</p>
<p><b>*</b> 512 = <font color=#a3682a><tt>
no_X_ticks</tt></font>: plot no x-ticks.</p>
<p><b>*</b> 1024 = <font color=#a3682a><tt>
no_Y_ticks</tt></font>: plot no y-ticks.</p>
<p><b>*</b> 2048 = <font color=#a3682a><tt>
Same_ticks</tt></font>: plot all ticks with the same length.</p>

<br>
<hr></hr><br>

<a name="plothraw"></a>
<h4><b>plothraw</b>(<u>listx</u>,<u>listy</u>,{<u>flag</u> = 0})</h4>
<p></p>
<p> given
<u>listx</u> and <u>listy</u> two vectors of equal length, plots (in high
precision) the points whose (x,y)-coordinates are given in <u>listx</u>
and <u>listy</u>. Automatic positioning and scaling is done, but with the
same scaling factor on x and y. If <u>flag</u> is 1, join points, other non-0
flags toggle display options and should be combinations of bits 2^k, k
 <font color=#a3682a><tt>
&#62;=</tt></font> 3 as in <font color=#a3682a><tt>
ploth</tt></font>.</p>

<br>
<hr></hr><br>

<a name="plothsizes"></a>
<h4><b>plothsizes</b>()</h4>
<p></p>
<p> return data corresponding to the output window
in the form of a 6-component vector: window width and height, sizes for ticks
in horizontal and vertical directions (this is intended for the <font color=#a3682a><tt>
gnuplot</tt></font>
interface and is currently not significant), width and height of characters.</p>

<br>
<hr></hr><br>

<a name="plotinit"></a>
<h4><b>plotinit</b>(w,x,y,{<u>flag</u>})</h4>
<p></p>
<p> initialize the rectwindow w,
destroying any rect objects you may have already drawn in w. The virtual
cursor is set to (0,0). The rectwindow size is set to width x and height
y. If <u>flag</u> = 0, x and y represent pixel units. Otherwise, x and y
are understood as fractions of the size of the current output device (hence
must be between 0 and 1) and internally converted to pixels.</p>
<p>The plotting device imposes an upper bound for x and y, for instance the
number of pixels for screen output. These bounds are available through the
<font color=#a3682a><tt>
plothsizes</tt></font> function. The following sequence initializes in a portable
way (i.e independent of the output device) a window of maximal size, accessed
through coordinates in the [0,1000]  x [0,1000] range:</p>
<p>
<pre><font color=#a3682a><tt>s = plothsizes();
&nbsp;plotinit(0, s[1]-1, s[2]-1);
&nbsp;plotscale(0, 0,1000, 0,1000);
</tt></font></pre></p>

<br>
<hr></hr><br>

<a name="plotkill"></a>
<h4><b>plotkill</b>(w)</h4>
<p></p>
<p> erase rectwindow w and free the corresponding
memory. Note that if you want to use the rectwindow w again, you have to
use <font color=#a3682a><tt>
plotinit</tt></font> first to specify the new size. So it's better in this case
to use <font color=#a3682a><tt>
plotinit</tt></font> directly as this throws away any previous work in the
given rectwindow.</p>

<br>
<hr></hr><br>

<a name="plotlines"></a>
<h4><b>plotlines</b>(w,X,Y,{<u>flag</u> = 0})</h4>
<p></p>
<p> draw on the rectwindow w
the polygon such that the (x,y)-coordinates of the vertices are in the
vectors of equal length X and Y. For simplicity, the whole
polygon is drawn, not only the part of the polygon which is inside the
rectwindow. If <u>flag</u> is non-zero, close the polygon. In any case, the
virtual cursor does not move.</p>
<p>X and Y are allowed to be scalars (in this case, both have to).
There, a single segment will be drawn, between the virtual cursor current
position and the point (X,Y). And only the part thereof which
actually lies within the boundary of w. Then <u>move</u> the virtual cursor
to (X,Y), even if it is outside the window. If you want to draw a
line from (x1,y1) to (x2,y2) where (x1,y1) is not necessarily the
position of the virtual cursor, use <font color=#a3682a><tt>
plotmove(w,x1,y1)</tt></font> before using this
function.</p>

<br>
<hr></hr><br>

<a name="plotlinetype"></a>
<h4><b>plotlinetype</b>(w,<u>type</u>)</h4>
<p></p>
<p> change the type of lines
subsequently plotted in rectwindow w. <u>type</u> -2 corresponds to
frames, -1 to axes, larger values may correspond to something else. w = 
-1 changes highlevel plotting. This is only taken into account by the
<font color=#a3682a><tt>
gnuplot</tt></font> interface.</p>

<br>
<hr></hr><br>

<a name="plotmove"></a>
<h4><b>plotmove</b>(w,x,y)</h4>
<p></p>
<p> move the virtual cursor of the rectwindow w
to position (x,y).</p>

<br>
<hr></hr><br>

<a name="plotpoints"></a>
<h4><b>plotpoints</b>(w,X,Y)</h4>
<p></p>
<p> draw on the rectwindow w the
points whose (x,y)-coordinates are in the vectors of equal length X and
Y and which are inside w. The virtual cursor does <u>not</u> move. This
is basically the same function as <font color=#a3682a><tt>
plothraw</tt></font>, but either with no scaling
factor or with a scale chosen using the function <font color=#a3682a><tt>
plotscale</tt></font>.</p>
<p>As was the case with the <font color=#a3682a><tt>
plotlines</tt></font> function, X and Y are allowed to
be (simultaneously) scalar. In this case, draw the single point (X,Y) on
the rectwindow w (if it is actually inside w), and in any case
<u>move</u> the virtual cursor to position (x,y).</p>

<br>
<hr></hr><br>

<a name="plotpointsize"></a>
<h4><b>plotpointsize</b>(w,size)</h4>
<p></p>
<p> changes the "size" of following
points in rectwindow w. If w = -1, change it in all rectwindows.
This only works in the <font color=#a3682a><tt>
gnuplot</tt></font> interface.</p>

<br>
<hr></hr><br>

<a name="plotpointtype"></a>
<h4><b>plotpointtype</b>(w,<u>type</u>)</h4>
<p></p>
<p>  change the type of
points subsequently plotted in rectwindow w. <u>type</u> = -1
corresponds to a dot, larger values may correspond to something else. w = -1
changes highlevel plotting. This is only taken into account by the
<font color=#a3682a><tt>
gnuplot</tt></font> interface.</p>

<br>
<hr></hr><br>

<a name="plotrbox"></a>
<h4><b>plotrbox</b>(w,dx,dy)</h4>
<p></p>
<p> draw in the rectwindow w the outline of
the rectangle which is such that the points (x1,y1) and (x1+dx,y1+dy) are
opposite corners, where (x1,y1) is the current position of the cursor.
Only the part of the rectangle which is in w is drawn. The virtual cursor
does <u>not</u> move.</p>

<br>
<hr></hr><br>

<a name="plotrecth"></a>
<h4><b>plotrecth</b>(w,X = a,b,<u>expr</u>,{<u>flag</u> = 0},{n = 0})</h4>
<p></p>
<p> writes to
rectwindow w the curve output of <font color=#a3682a><tt>
ploth</tt></font>(w,X = a,b,<u>expr</u>,<u>flag</u>,n).</p>

<br>
<hr></hr><br>

<a name="plotrecthraw"></a>
<h4><b>plotrecthraw</b>(w,<u>data</u>,{<u>flag</u> = 0})</h4>
<p></p>
<p> plot graph(s) for
<u>data</u> in rectwindow w. <u>flag</u> has the same significance here as in
<font color=#a3682a><tt>
ploth</tt></font>, though recursive plot is no more significant.</p>
<p><u>data</u> is a vector of vectors, each corresponding to a list a coordinates.
If parametric plot is set, there must be an even number of vectors, each
successive pair corresponding to a curve. Otherwise, the first one contains
the x coordinates, and the other ones contain the y-coordinates
of curves to plot.</p>

<br>
<hr></hr><br>

<a name="plotrline"></a>
<h4><b>plotrline</b>(w,dx,dy)</h4>
<p></p>
<p> draw in the rectwindow w the part of the
segment (x1,y1)-(x1+dx,y1+dy) which is inside w, where (x1,y1) is the
current position of the virtual cursor, and move the virtual cursor to
(x1+dx,y1+dy) (even if it is outside the window).</p>

<br>
<hr></hr><br>

<a name="plotrmove"></a>
<h4><b>plotrmove</b>(w,dx,dy)</h4>
<p></p>
<p> move the virtual cursor of the rectwindow
w to position (x1+dx,y1+dy), where (x1,y1) is the initial position of
the cursor (i.e.to position (dx,dy) relative to the initial cursor).</p>

<br>
<hr></hr><br>

<a name="plotrpoint"></a>
<h4><b>plotrpoint</b>(w,dx,dy)</h4>
<p></p>
<p> draw the point (x1+dx,y1+dy) on the
rectwindow w (if it is inside w), where (x1,y1) is the current position
of the cursor, and in any case move the virtual cursor to position
(x1+dx,y1+dy).</p>

<br>
<hr></hr><br>

<a name="plotscale"></a>
<h4><b>plotscale</b>(w,x1,x2,y1,y2)</h4>
<p></p>
<p> scale the local coordinates of the
rectwindow w so that x goes from x1 to x2 and y goes from y1 to
y2 (x2 &#60; x1 and y2 &#60; y1 being allowed). Initially, after the initialization
of the rectwindow w using the function <font color=#a3682a><tt>
plotinit</tt></font>, the default scaling
is the graphic pixel count, and in particular the y axis is oriented
downwards since the origin is at the upper left. The function <font color=#a3682a><tt>
plotscale</tt></font>
allows to change all these defaults and should be used whenever functions are
graphed.</p>

<br>
<hr></hr><br>

<a name="plotstring"></a>
<h4><b>plotstring</b>(w,x,{<u>flag</u> = 0})</h4>
<p></p>
<p> draw on the rectwindow w the
String x (see Section [<b>Label: se:strings</b>]), at the current position of the cursor.</p>
<p><u>flag</u> is used for justification: bits 1 and 2 regulate horizontal alignment:
left if 0, right if 2, center if 1. Bits 4 and 8 regulate vertical
alignment: bottom if 0, top if 8, v-center if 4. Can insert additional
small gap between point and string: horizontal if bit 16 is set, vertical
if bit 32 is set (see the tutorial for an example).</p>

<br>
<hr></hr><br>

<a name="psdraw"></a>
<h4><b>psdraw</b>(<u>list</u>)</h4>
<p></p>
<p> same as <font color=#a3682a><tt>
plotdraw</tt></font>, except that the
output is a PostScript program appended to the <font color=#a3682a><tt>
psfile</tt></font>.</p>

<br>
<hr></hr><br>

<a name="psploth"></a>
<h4><b>psploth</b>(X = a,b,<u>expr</u>)</h4>
<p></p>
<p> same as <font color=#a3682a><tt>
ploth</tt></font>, except that the
output is a PostScript program appended to the <font color=#a3682a><tt>
psfile</tt></font>.</p>

<br>
<hr></hr><br>

<a name="psplothraw"></a>
<h4><b>psplothraw</b>(<u>listx</u>,<u>listy</u>)</h4>
<p></p>
<p> same as <font color=#a3682a><tt>
plothraw</tt></font>,
except that the output is a PostScript program appended to the <font color=#a3682a><tt>
psfile</tt></font>.</p>

<br>
<hr></hr><br>



</BODY>
</HTML>